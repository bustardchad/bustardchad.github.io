[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Chad Bustard",
    "section": "",
    "text": "Chad Bustard is a data enthusiast and machine learning practicioner leveraging large-scale simulations, Python-based data analysis, and a start-up mindset to solve novel problems in astrophysics. He’s now adapting and growing his technical skillset to tackle climate change."
  },
  {
    "objectID": "about.html#education",
    "href": "about.html#education",
    "title": "Chad Bustard",
    "section": "Education",
    "text": "Education\nUniversity of Wisconsin-Madison | PhD in Physics | June 2014 - August 2020\nRice University | B.S. in Astrophysics, B.A. in Mathematics | August 2009 - May 2013"
  },
  {
    "objectID": "about.html#experience",
    "href": "about.html#experience",
    "title": "Chad Bustard",
    "section": "Experience",
    "text": "Experience\nClimatebase | Climatebase Fellow (Cohort 4) | September 2023 - present\nKavli Institute for Theoretical Physics | Postdoctoral Fellow | September 2020 - September 2023\nUniversity of Wisconsin - Madison | NSF Graduate Fellow | June 2014 - August 2020"
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "From Galaxy Atmospheres to Saving Earth’s Atmosphere",
    "section": "",
    "text": "Announcing a series of blog posts spanning machine learning, climate science, galactic winds, and cosmic rays!\nYou’re probably thinking, “None of these topics are connected, and some of these words sound made up…this blog is going to be an incoherent mess, and the author must be too!”\nWell, let me explain…\n\nFrom Galaxy Atmospheres…\nI’m a computational astrophysicist by training. I got my PhD in Physics in 2020 from University of Wisconsin-Madison simulating the gas flows in and around galaxies. I particularly focused on how galaxies can drive large-scale outflows (“galactic winds”) into their surrounding atmospheres (the circumgalactic medium). For 6 years, I designed and built new astrophysics modules and integrated them with massively parallel C++ and Fortran-based codebases, ran large-scale models on some of the country’s largest supercomputers, and analyzed terabytes of data using Python-based data science tools (e.g. Numpy, Pandas, Scipy).\nI then did a 3-year postdoctoral fellowship at the Kavli Institute for Theoretical Physics at UC-Santa Barbara, where I was the principal investigator (PI) on a supercomputing grant (&gt; 15 million CPU hours) supporting multiple postdoc and PhD projects. Our main objectives were to better understand how cold clouds in galaxy atmospheres survive fluid instabilities and “rain” down on galaxies, and how relativistic charged particles called cosmic rays can significantly alter galaxies and their surroundings despite comprising only a billionth of all particles in the Universe.\nMost recently, I’ve created a &gt;10 terabyte simulation suite exploring the interplay between cosmic rays and magnetized turbulence (Bustard and Oh 2022, 2023), and using those images as training data, I’ve developed a novel technique to reveal cosmic ray properties from gas density images using convolutional neural networks (Bustard and Wu, in prep). This project is ready for journal submission, so look for a blog post about this very soon!\n\n\n…To Lots and Lots of Self-Reflection…\nI’ve greatly enjoyed my time as a computational astrophysicist, especially the diverse and intellectually stimulating collaborations and the opportunities to sculpt and advise projects for 6 junior researchers; however, I’ve also become more aware of my personal priorities that are at odds with the traditional academic route, e.g. having flexibility in work location (ask me about New Mexico and Wisconsin, two under-appreciated states I plan to spend a lot of time in), creating positive contributions to society beyond the accumulation and dissemination of knowledge, and maybe contributing a bit more financially to our family so my partner doesn’t have to bear the entire load any more.\nFor those reasons and others, I recently decided to forego a career in academia and test the job market for data science, machine learning, and software engineering roles! Instead of all roads leading to tenure-track, I’m now exploring dozens of career paths, which on one hand is very overwhelming, but on the other hand, very freeing and exciting!\n\n\n…To Saving Earth’s Atmosphere\nWhile I’m genuinely enthused to tackle complex, ambiguous problems of all sorts, one path in particular stands out: climate science, particularly data-intensive solutions to climate change such as optimized transportation, smart use of the power grid, and machine learning-informed verification and monitoring of corporate greenhouse gas emissions. During the current explosion of AI in our daily lives, from chatbots to pointed advertisements, I’m optimistic that AI can also support our necessary fight to offset global warming.\nTo that end, I recently participated in a series of lectures and tutorials at the Climate Change AI 2023 Summer School, where I greatly expanded my knowledge of clean energy funding and regulations, cutting-edge climate science research, and use-cases of machine learning in this space, from natural language processing to remote sensing and computer vision.\nStarting September 25th, I’ll be one of the few hundred Climatebase Fellows (Cohort 4) accepted out of a pool of a few thousand! I’ll spend 12 weeks connecting with other like-minded individuals from diverse academic and professional backgrounds, learning about global warming and efforts in the tech industry to slow and reverse the warming trend, and devising and executing a collaborative capstone project to present to industry professionals later this year!\n\n\nWhy create a blog?\nI’m naming this blog “From Galaxy Atmospheres to Saving Earth’s Atmosphere” partly because it’s catchier than “My Blog” but mainly because I hope it captures a story of transition from theoretical astrophysics research to applied climate technology, an area I imagine many other STEM and non-STEM PhDs would be thrilled to join but probably don’t know where to start. As I’ve found out over the last 2 years, making a career transition is extremely difficult. It first requires you to divest from your one-track career path and your past identity, which may have been engrained in you for many years; this part is the hardest and takes the longest. It then requires you to embrace uncertainty and ask others for help; this part is uncomfortable. Then it requires you to pour over your previous career and remind yourself what you’ve done, put all of that in a presentable resume, cover letter, blog, etc. and start applying; as of writing, this is my current phase.\nI hope that 5 years from now, when I’m an established climate technologist leading a successful group of diverse, remote, and enthusiastic data scientists, a data-oriented PhD will find this blog, feel empowered to make a scary career switch, learn a thing or two about the transition to industry, and see the exciting steps we’ve taken towards off-setting global warming. For now, this blog is meant to show a bit of who I am, a bit of what I’ve done as an astrophysics researcher, and a bit of what I’m currently learning as I explore the realm of clean energy and AI-informed solutions to global warming. Cheers to you for reading this far!\n\nAbove is a beautiful stock image (which looks surprisingly similar to my current desk setup) for a Quarto-generated blog post. Quarto allows you to convert things like Jupyter notebooks to pretty blog posts hosted on a variety of platforms, such as GitHub Pages."
  },
  {
    "objectID": "posts/post-with-code/index.html",
    "href": "posts/post-with-code/index.html",
    "title": "LMC Analysis: Part I",
    "section": "",
    "text": "This notebook goes through a few analyses of simulation data, specifically the simulations published in Bustard et al. 2020 of ram pressure stripping and supernova-driven outflows from the Large Magellanic Cloud.\n\n\nIn this notebook (part I), we will extract a few mock observables from the dataset, including rotation measure (which is a probe of magnetic field strength), gamma-ray emission (which probes cosmic ray content), and ion column densities. Then we’ll make a few mock absorption line spectra comparable to that from the COS-Halos spectrograph aboard the Hubble Space Telescope.\nIn part II, we will plot values of “ram pressure” across the LMC disk and tabulate them at specific points where there are observational sightlines (this part, followed by an analysis of correlations between local ram pressure and observed ion abundances forms the basis for a funded Hubble Space Telescope (HST) grant (PI: Yong Zheng, Co-I: Chad Bustard)\n\n\n\n\nWhy do these simulations?\nWhat goes into these simulations?\nWhat do the simulations look like?\nSimulation analysis – mock observations\n\n\n\n\nPandas, yt, Trident, astropy"
  },
  {
    "objectID": "posts/post-with-code/index.html#mock-observables-from-models-of-the-large-magellanic-cloud",
    "href": "posts/post-with-code/index.html#mock-observables-from-models-of-the-large-magellanic-cloud",
    "title": "LMC Analysis: Part I",
    "section": "",
    "text": "This notebook goes through a few analyses of simulation data, specifically the simulations published in Bustard et al. 2020 of ram pressure stripping and supernova-driven outflows from the Large Magellanic Cloud.\n\n\nIn this notebook (part I), we will extract a few mock observables from the dataset, including rotation measure (which is a probe of magnetic field strength), gamma-ray emission (which probes cosmic ray content), and ion column densities. Then we’ll make a few mock absorption line spectra comparable to that from the COS-Halos spectrograph aboard the Hubble Space Telescope.\nIn part II, we will plot values of “ram pressure” across the LMC disk and tabulate them at specific points where there are observational sightlines (this part, followed by an analysis of correlations between local ram pressure and observed ion abundances forms the basis for a funded Hubble Space Telescope (HST) grant (PI: Yong Zheng, Co-I: Chad Bustard)\n\n\n\n\nWhy do these simulations?\nWhat goes into these simulations?\nWhat do the simulations look like?\nSimulation analysis – mock observations\n\n\n\n\nPandas, yt, Trident, astropy"
  },
  {
    "objectID": "posts/post-with-code/index.html#background",
    "href": "posts/post-with-code/index.html#background",
    "title": "LMC Analysis: Part I",
    "section": "Background",
    "text": "Background\n\nWhy were these simulations created?\nHow gas flows in and out of galaxies is an important and open question in galaxy formation and evolution. Large-scale supernova-driven outflows (or winds) from galaxies are prevalent throughout the Universe and can greatly impact galaxy evolution by quenching star formation and redistributing metals from the inner galaxy to the circumgalactic medium. The composition of these outflows and the physical processes that drive them, however, are not well understood, and there are large discrepancies between observations and theory. This project closes those gaps by creating synthetic, multi-wavelength observations of outflow simulations to be compared to observations from Chandra, HST, JWST, and other current and future telescopes.\nSpecifically, our simulations focus on the Large Magellanic Cloud (LMC), a dwarf galaxy roughly 50 kiloparsecs from the Milky Way that exhibits evidence for galactic winds. The LMC also has a rich interaction history with its neighbor, the Small Magellanic Cloud (SMC), which allows us to probe how a galaxy’s environment affects outflow generation and dynamics. While falling into the Milky Way halo, the Clouds orbit around each other, triggering bursts of star formation and also tearing each other apart as their gravitational forces loosen and strip material. Combined with the constant headwind they experience during their infall, their galactic dance flings gas behind the Clouds, contributing to the Trailing Magellanic Stream. This massive gaseous tail extending tens of kiloparsecs behind the Clouds may someday fall onto the Milky Way disk and enhance our Galactic ecosystem by providing more fuel to form stars. Fortunately, because of our birds-eye view, the Magellanic System gives us an incredible window into how galaxies expel and feed on gas; both the large-scale gas cycles in and between galaxies, as well as the small-scale, internal processes that drive gas flows.\nMore specifically, this project looks at the generation of supernova-driven outflows from the LMC and their interaction with ram pressure, the pressure that a galaxy feels as it moves through a static background. Individually, these processes are known to oppose gravity and remove gas from galaxies, but in concert, their effects are less well known.\n\n\nWhat goes into these simulations?\nIn Bustard et al. 2018, we modeled individual, idealized gas outbursts from the LMC and their interaction with a headwind directed parallel to the LMC disk axis.\nHere, in Bustard et al. 2020, we increase complexity and realism in important ways:\n\nWe use active particles in FLASH to represent clusters of stars that evolve and explode over a given time period, depositing energy and momentum to the surrounding cells according to the fitting functions of Martizzi et al. 2015 and the star cluster implementation of Semenov et al. 2016.\nPart of the energy released from supernovae goes into cosmic rays. Cosmic rays are relativistic particles, comprising only about a billionth of all particles in the Milky Way, but their energies are so high that, collectively, the cosmic ray population has an equal importance to galaxy dynamics and thermodynamics. Cosmic rays are of specific interest because of their ability to help launch galactic outflows. The FLASH cosmic ray module we employ has been used in numerous galaxy-scale simulations as well as in recent localized simulations of a stratified ISM made unstable by cosmic ray streaming (Heintz, Bustard, and Zweibel 2020).\nProbably the most novel part of these simulations…the creation of star cluster particles is directly tied to the spatially resolved star formation history of the LMC! Small-scale structures resolved by observations of the Magellanic Clouds, as well as the reconstructed star formation histories of the Clouds, afford us the opportunity to test the cumulative effects of various physical processes on outflow and fountain generation. Specifically, we have included into our model the derived star formation sites in the LMC over the past billion years. This is done by reading in data files containing the star formation rate at over 1300 (x,y) coordinates at 10 time snapshots. In between these coarse time snapshots, we randomly draw cluster masses from a probability distribution function, which we can vary, and populate each (x,y) coordinate with star clusters such that the total mass formed as stars matches the total mass known to form during that time interval. We leave the number of star forming events as a free parameter; fewer events necessitates either larger mass particles or more particles per event (supernovae that are more clustered), while more frequent events necessitates lower mass particles. This allows us to probe the effects of supernova clustering on outflow generation.\n\n\n\nWhat do the full simulations look like?\nThe video below shows volume renderings of the LMC gas pressure over the course of a billion (simulated) years of LMC evolution, including the generation of supernova-driven outflows and ram pressure stripping of loosely connected gas.\nIn the following cells, we’ll take a closer look at the simulation data ourselves…\n\nfrom IPython import display\ndisplay.Video(\"Image_Video_Files/movie_GasPres_timeseries.mp4\", embed=True)\n\n\n \n Your browser does not support the video tag.\n \n\n\n\n# Import all the packages we need\n#!pip install --upgrade yt\n#!pip install trident\n!pip install aplpy\nimport yt\nimport trident\nfrom trident import LightRay\nimport aplpy\nimport numpy as np\n#import matplotlib as plt\nfrom yt.units.yt_array import YTQuantity\nfrom yt import YTArray\nimport h5py\nimport matplotlib.pyplot as plt\nfrom astropy.io import fits\nfrom astropy.table import Table\nfrom astropy import wcs\nfrom astropy.wcs import WCS\nimport csv\nimport pandas as pd\n\n!pip install cmasher # a nice repository of colorblind-friendly, aesthetically pleasing colormaps\nimport cmasher as cmr\n\nRequirement already satisfied: aplpy in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (2.1.0)\nRequirement already satisfied: numpy in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from aplpy) (1.25.2)\nRequirement already satisfied: astropy&gt;=3.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from aplpy) (5.3.1)\nRequirement already satisfied: matplotlib&gt;=2.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from aplpy) (3.7.2)\nRequirement already satisfied: reproject&gt;=0.4 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from aplpy) (0.12.0)\nRequirement already satisfied: pyregion&gt;=2.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from aplpy) (2.2.0)\nRequirement already satisfied: pillow&gt;=4.3 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from aplpy) (10.0.0)\nRequirement already satisfied: pyavm&gt;=0.9.4 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from aplpy) (0.9.5)\nRequirement already satisfied: scikit-image&gt;=0.14 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from aplpy) (0.21.0)\nRequirement already satisfied: shapely&gt;=1.7 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from aplpy) (2.0.1)\nRequirement already satisfied: pyerfa&gt;=2.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from astropy&gt;=3.1-&gt;aplpy) (2.0.0.3)\nRequirement already satisfied: PyYAML&gt;=3.13 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from astropy&gt;=3.1-&gt;aplpy) (6.0.1)\nRequirement already satisfied: packaging&gt;=19.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from astropy&gt;=3.1-&gt;aplpy) (23.1)\nRequirement already satisfied: contourpy&gt;=1.0.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.0-&gt;aplpy) (1.1.0)\nRequirement already satisfied: cycler&gt;=0.10 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.0-&gt;aplpy) (0.11.0)\nRequirement already satisfied: fonttools&gt;=4.22.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.0-&gt;aplpy) (4.42.0)\nRequirement already satisfied: kiwisolver&gt;=1.0.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.0-&gt;aplpy) (1.4.4)\nRequirement already satisfied: pyparsing&lt;3.1,&gt;=2.3.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.0-&gt;aplpy) (3.0.9)\nRequirement already satisfied: python-dateutil&gt;=2.7 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.0-&gt;aplpy) (2.8.2)\nRequirement already satisfied: astropy-healpix&gt;=0.6 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from reproject&gt;=0.4-&gt;aplpy) (1.0.0)\nRequirement already satisfied: scipy&gt;=1.5 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from reproject&gt;=0.4-&gt;aplpy) (1.11.1)\nRequirement already satisfied: dask[array]&gt;=2021.8 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from reproject&gt;=0.4-&gt;aplpy) (2023.9.1)\nRequirement already satisfied: cloudpickle in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from reproject&gt;=0.4-&gt;aplpy) (2.2.1)\nRequirement already satisfied: zarr in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from reproject&gt;=0.4-&gt;aplpy) (2.16.1)\nRequirement already satisfied: fsspec in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from reproject&gt;=0.4-&gt;aplpy) (2023.9.0)\nRequirement already satisfied: networkx&gt;=2.8 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from scikit-image&gt;=0.14-&gt;aplpy) (3.1)\nRequirement already satisfied: imageio&gt;=2.27 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from scikit-image&gt;=0.14-&gt;aplpy) (2.31.1)\nRequirement already satisfied: tifffile&gt;=2022.8.12 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from scikit-image&gt;=0.14-&gt;aplpy) (2023.7.18)\nRequirement already satisfied: PyWavelets&gt;=1.1.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from scikit-image&gt;=0.14-&gt;aplpy) (1.4.1)\nRequirement already satisfied: lazy_loader&gt;=0.2 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from scikit-image&gt;=0.14-&gt;aplpy) (0.3)\nRequirement already satisfied: click&gt;=8.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from dask[array]&gt;=2021.8-&gt;reproject&gt;=0.4-&gt;aplpy) (8.1.7)\nRequirement already satisfied: partd&gt;=1.2.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from dask[array]&gt;=2021.8-&gt;reproject&gt;=0.4-&gt;aplpy) (1.4.0)\nRequirement already satisfied: toolz&gt;=0.10.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from dask[array]&gt;=2021.8-&gt;reproject&gt;=0.4-&gt;aplpy) (0.12.0)\nRequirement already satisfied: importlib-metadata&gt;=4.13.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from dask[array]&gt;=2021.8-&gt;reproject&gt;=0.4-&gt;aplpy) (6.8.0)\nRequirement already satisfied: six&gt;=1.5 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=2.0-&gt;aplpy) (1.16.0)\nRequirement already satisfied: asciitree in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from zarr-&gt;reproject&gt;=0.4-&gt;aplpy) (0.3.3)\nRequirement already satisfied: fasteners in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from zarr-&gt;reproject&gt;=0.4-&gt;aplpy) (0.18)\nRequirement already satisfied: numcodecs&gt;=0.10.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from zarr-&gt;reproject&gt;=0.4-&gt;aplpy) (0.11.0)\nRequirement already satisfied: zipp&gt;=0.5 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from importlib-metadata&gt;=4.13.0-&gt;dask[array]&gt;=2021.8-&gt;reproject&gt;=0.4-&gt;aplpy) (3.16.2)\nRequirement already satisfied: entrypoints in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from numcodecs&gt;=0.10.0-&gt;zarr-&gt;reproject&gt;=0.4-&gt;aplpy) (0.4)\nRequirement already satisfied: locket in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from partd&gt;=1.2.0-&gt;dask[array]&gt;=2021.8-&gt;reproject&gt;=0.4-&gt;aplpy) (1.0.0)\nRequirement already satisfied: cmasher in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (1.6.3)\nRequirement already satisfied: colorspacious&gt;=1.1.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from cmasher) (1.1.2)\nRequirement already satisfied: e13tools&gt;=0.9.4 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from cmasher) (0.9.6)\nRequirement already satisfied: matplotlib&gt;=2.2.4 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from cmasher) (3.7.2)\nRequirement already satisfied: numpy&gt;=1.16.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from cmasher) (1.25.2)\nRequirement already satisfied: contourpy&gt;=1.0.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (1.1.0)\nRequirement already satisfied: cycler&gt;=0.10 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (0.11.0)\nRequirement already satisfied: fonttools&gt;=4.22.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (4.42.0)\nRequirement already satisfied: kiwisolver&gt;=1.0.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (1.4.4)\nRequirement already satisfied: packaging&gt;=20.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (23.1)\nRequirement already satisfied: pillow&gt;=6.2.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (10.0.0)\nRequirement already satisfied: pyparsing&lt;3.1,&gt;=2.3.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (3.0.9)\nRequirement already satisfied: python-dateutil&gt;=2.7 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (2.8.2)\nRequirement already satisfied: six&gt;=1.5 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=2.2.4-&gt;cmasher) (1.16.0)\n\n\n\n# Get the HDF5 file from my Google Drive\n# Note: Can delete this cell if the HDF5 file is already downloaded\n#!pip install gdown\n#!gdown \"https://drive.google.com/uc?id=1BCvIdYOA3VZj91Fdh9seOki0ww3Rqiky\""
  },
  {
    "objectID": "posts/post-with-code/index.html#a-first-look-at-the-simulation-data",
    "href": "posts/post-with-code/index.html#a-first-look-at-the-simulation-data",
    "title": "LMC Analysis: Part I",
    "section": "A first look at the simulation data",
    "text": "A first look at the simulation data\nFor the remainder of this notebook, we employ the yt package, a visualization and analysis toolkit for astrophysics: https://yt-project.org/.\nLet’s start by loading the present-day LMC snapshot and printing off the fields that yt knows about. Then let’s take a look at density and temperature slices of the simulations parallel and perpendicular to the axis of the disk.\n\n# Load our dataset with yt\nyt.enable_parallelism() # for large data files (or multiple files), yt can be parallelized with this command. Here we don't need it\n\n# general way to load in a series of snapshots, in this case just the final snapshot of the 50 I output during the simulation\nds = yt.load(\"windCRs_hdf5_plt_cnt_0050\")\n\ndd = ds.all_data()\n\n# just giving the simulation box periodic boundaries (so we can calculate gradients if we want to without throwing errors)\n#ds.periodicity=(True,True,True)\n        \n# rearranging coordinates \nds.coordinates.x_axis[1] = 0\nds.coordinates.y_axis[1] = 2\n\n# Let's take a look at all the quantities or \"fields\" known to yt derived from the ~10 output variables in the HDF5 file\nprint(ds.derived_field_list)\n\nyt : [ERROR    ] 2023-09-11 17:00:20,457 Could not enable parallelism: mpi4py is not installed\nyt : [INFO     ] 2023-09-11 17:00:20,572 Parameters: current_time              = 3.156010944496386e+16\nyt : [INFO     ] 2023-09-11 17:00:20,573 Parameters: domain_dimensions         = [96 96 96]\nyt : [INFO     ] 2023-09-11 17:00:20,573 Parameters: domain_left_edge          = [-6.171e+22 -6.171e+22 -6.171e+22]\nyt : [INFO     ] 2023-09-11 17:00:20,574 Parameters: domain_right_edge         = [1.234e+23 1.234e+23 1.234e+23]\nyt : [INFO     ] 2023-09-11 17:00:20,574 Parameters: cosmological_simulation   = 0\n\n\n[('flash', 'cell_volume'), ('flash', 'cloo'), ('flash', 'cray'), ('flash', 'dens'), ('flash', 'dx'), ('flash', 'dy'), ('flash', 'dz'), ('flash', 'haco'), ('flash', 'hrat'), ('flash', 'igm '), ('flash', 'ism '), ('flash', 'magx'), ('flash', 'magy'), ('flash', 'magz'), ('flash', 'mtl '), ('flash', 'path_element_x'), ('flash', 'path_element_y'), ('flash', 'path_element_z'), ('flash', 'pres'), ('flash', 'temp'), ('flash', 'velx'), ('flash', 'vely'), ('flash', 'velz'), ('flash', 'volume'), ('flash', 'x'), ('flash', 'y'), ('flash', 'z'), ('gas', 'alfven_speed'), ('gas', 'angular_momentum_magnitude'), ('gas', 'angular_momentum_x'), ('gas', 'angular_momentum_y'), ('gas', 'angular_momentum_z'), ('gas', 'averaged_density'), ('gas', 'baroclinic_vorticity_magnitude'), ('gas', 'baroclinic_vorticity_x'), ('gas', 'baroclinic_vorticity_y'), ('gas', 'baroclinic_vorticity_z'), ('gas', 'cell_mass'), ('gas', 'cell_volume'), ('gas', 'courant_time_step'), ('gas', 'cutting_plane_magnetic_field_x'), ('gas', 'cutting_plane_magnetic_field_y'), ('gas', 'cutting_plane_magnetic_field_z'), ('gas', 'cutting_plane_velocity_x'), ('gas', 'cutting_plane_velocity_y'), ('gas', 'cutting_plane_velocity_z'), ('gas', 'density'), ('gas', 'density_gradient_magnitude'), ('gas', 'density_gradient_x'), ('gas', 'density_gradient_y'), ('gas', 'density_gradient_z'), ('gas', 'dx'), ('gas', 'dy'), ('gas', 'dynamical_time'), ('gas', 'dz'), ('gas', 'four_velocity_magnitude'), ('gas', 'four_velocity_t'), ('gas', 'four_velocity_x'), ('gas', 'four_velocity_y'), ('gas', 'four_velocity_z'), ('gas', 'jeans_mass'), ('gas', 'kT'), ('gas', 'kinetic_energy_density'), ('gas', 'lorentz_factor'), ('gas', 'mach_alfven'), ('gas', 'mach_number'), ('gas', 'magnetic_energy_density'), ('gas', 'magnetic_field_cylindrical_radius'), ('gas', 'magnetic_field_cylindrical_theta'), ('gas', 'magnetic_field_cylindrical_z'), ('gas', 'magnetic_field_divergence'), ('gas', 'magnetic_field_divergence_absolute'), ('gas', 'magnetic_field_los'), ('gas', 'magnetic_field_magnitude'), ('gas', 'magnetic_field_poloidal'), ('gas', 'magnetic_field_poloidal_magnitude'), ('gas', 'magnetic_field_spherical_phi'), ('gas', 'magnetic_field_spherical_radius'), ('gas', 'magnetic_field_spherical_theta'), ('gas', 'magnetic_field_strength'), ('gas', 'magnetic_field_toroidal'), ('gas', 'magnetic_field_toroidal_magnitude'), ('gas', 'magnetic_field_x'), ('gas', 'magnetic_field_y'), ('gas', 'magnetic_field_z'), ('gas', 'magnetic_pressure'), ('gas', 'mass'), ('gas', 'mean_molecular_weight'), ('gas', 'momentum_density_x'), ('gas', 'momentum_density_y'), ('gas', 'momentum_density_z'), ('gas', 'momentum_x'), ('gas', 'momentum_y'), ('gas', 'momentum_z'), ('gas', 'number_density'), ('gas', 'path_element_x'), ('gas', 'path_element_y'), ('gas', 'path_element_z'), ('gas', 'plasma_beta'), ('gas', 'pressure'), ('gas', 'pressure_gradient_magnitude'), ('gas', 'pressure_gradient_x'), ('gas', 'pressure_gradient_y'), ('gas', 'pressure_gradient_z'), ('gas', 'radial_mach_number'), ('gas', 'radial_magnetic_field'), ('gas', 'radial_magnetic_field_absolute'), ('gas', 'radial_velocity'), ('gas', 'radial_velocity_absolute'), ('gas', 'relative_magnetic_field_x'), ('gas', 'relative_magnetic_field_y'), ('gas', 'relative_magnetic_field_z'), ('gas', 'relative_velocity_x'), ('gas', 'relative_velocity_y'), ('gas', 'relative_velocity_z'), ('gas', 'shear'), ('gas', 'shear_criterion'), ('gas', 'shear_mach'), ('gas', 'sound_speed'), ('gas', 'specific_angular_momentum_magnitude'), ('gas', 'specific_angular_momentum_x'), ('gas', 'specific_angular_momentum_y'), ('gas', 'specific_angular_momentum_z'), ('gas', 'tangential_magnetic_field'), ('gas', 'tangential_over_magnetic_field_magnitude'), ('gas', 'tangential_over_velocity_magnitude'), ('gas', 'tangential_velocity'), ('gas', 'temperature'), ('gas', 'velocity_cylindrical_radius'), ('gas', 'velocity_cylindrical_theta'), ('gas', 'velocity_cylindrical_z'), ('gas', 'velocity_divergence'), ('gas', 'velocity_divergence_absolute'), ('gas', 'velocity_los'), ('gas', 'velocity_magnitude'), ('gas', 'velocity_spherical_phi'), ('gas', 'velocity_spherical_radius'), ('gas', 'velocity_spherical_theta'), ('gas', 'velocity_x'), ('gas', 'velocity_y'), ('gas', 'velocity_z'), ('gas', 'volume'), ('gas', 'vorticity_growth_magnitude'), ('gas', 'vorticity_growth_magnitude_absolute'), ('gas', 'vorticity_growth_timescale'), ('gas', 'vorticity_growth_x'), ('gas', 'vorticity_growth_y'), ('gas', 'vorticity_growth_z'), ('gas', 'vorticity_magnitude'), ('gas', 'vorticity_squared'), ('gas', 'vorticity_stretching_magnitude'), ('gas', 'vorticity_stretching_x'), ('gas', 'vorticity_stretching_y'), ('gas', 'vorticity_stretching_z'), ('gas', 'vorticity_x'), ('gas', 'vorticity_y'), ('gas', 'vorticity_z'), ('gas', 'x'), ('gas', 'y'), ('gas', 'z'), ('index', 'cell_volume'), ('index', 'cylindrical_radius'), ('index', 'cylindrical_theta'), ('index', 'cylindrical_z'), ('index', 'dx'), ('index', 'dy'), ('index', 'dz'), ('index', 'grid_indices'), ('index', 'grid_level'), ('index', 'morton_index'), ('index', 'ones'), ('index', 'ones_over_dx'), ('index', 'path_element_x'), ('index', 'path_element_y'), ('index', 'path_element_z'), ('index', 'radius'), ('index', 'spherical_phi'), ('index', 'spherical_radius'), ('index', 'spherical_theta'), ('index', 'virial_radius_fraction'), ('index', 'volume'), ('index', 'x'), ('index', 'y'), ('index', 'z'), ('index', 'zeros')]\n\n\nLet’s take a quick look at the simulations to see what we have. We’ll start with Slice plots, which just look at a 2D array of cells, both in the plane of the disk and vertical to the plane of the disk.\n\n# Plot a slice of the hydrogen number density -- # of hydrogen particles per cubic centimeter -- in the plane of the disk\nfield = (\"gas\",\"number_density\")\nproj = yt.SlicePlot(ds, \"z\", field,center = (0,0,0), width=(20, 'kpc'))\nproj.set_cmap(field=field, cmap='cmr.eclipse')\nproj.set_colorbar_label(field, r\"Density (cm$^{-3}$)\")\nproj.set_zlim(field,1e-3,1e0)\nproj.annotate_timestamp()\nproj.show()\n\nproj = yt.SlicePlot(ds, \"x\", field,center = (0,0,0), width=(20, 'kpc'))\nproj.set_cmap(field=field, cmap='cmr.eclipse')\nproj.set_colorbar_label(field, r\"Density (cm$^{-3}$)\")\nproj.set_zlim(field,1e-3,1e0)\nproj.annotate_timestamp()\nproj.show()\n\nfield = (\"gas\",\"temperature\")\nproj = yt.SlicePlot(ds, \"z\", field,center = (0,0,0), width=(20, 'kpc'))\nproj.set_cmap(field=field, cmap='cmr.eclipse')\nproj.set_colorbar_label(field, r\"Temperature (K)\")\nproj.set_zlim(field,1e3,1e7)\nproj.annotate_timestamp()\nproj.show()\n\nproj = yt.SlicePlot(ds, \"x\", field,center = (0,0,0), width=(20, 'kpc'))\nproj.set_cmap(field=field, cmap='cmr.eclipse')\nproj.set_colorbar_label(field, r\"Temperature (K)\")\nproj.set_zlim(field,1e3,1e7)\nproj.annotate_timestamp()\nproj.show()\n\nyt : [INFO     ] 2023-09-11 17:00:22,358 xlim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:22,359 ylim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:22,362 xlim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:22,362 ylim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:22,365 Making a fixed resolution buffer of (('gas', 'number_density')) 800 by 800\nyt : [INFO     ] 2023-09-11 17:00:23,318 xlim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:23,320 ylim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:23,322 xlim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:23,323 ylim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:23,324 Making a fixed resolution buffer of (('gas', 'number_density')) 800 by 800\nyt : [INFO     ] 2023-09-11 17:00:23,906 xlim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:23,907 ylim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:23,909 xlim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:23,909 ylim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:23,910 Making a fixed resolution buffer of (('gas', 'temperature')) 800 by 800\nyt : [INFO     ] 2023-09-11 17:00:24,714 xlim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:24,714 ylim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:24,715 xlim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:24,715 ylim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:24,716 Making a fixed resolution buffer of (('gas', 'temperature')) 800 by 800\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe can see a lot of interesting physics at play here, as well as some info about the simulation methodology.\nFirst, you might notice in the last figure, which shows a vertical view of the temperature, that the actual cells of the simulation are noticeable in the region far above the disk. This is because we derefine the grid in areas with lower density. The cells are more densely spaced near the center of the galaxy, specifically at regions where the gas density is highest; this technique is called adaptive mesh refinement (AMR) and is commonly used to focus resolution on certain areas of the simulation box. In this case, every n timesteps in the simulation (here set to be ~100 timesteps), the grid will re-assess the gas density and restructure itself. This technique saves on computation time and memory. If the entire simulation domain were tiled by small cells, the simulation would be intractable.\nSecond, check out the structures that have formed in the LMC disk. Clusters of supernova explosions have heated and ejected the gas (as one can see in the vertical slices), carving out hot, diffuse holes surrounded by dense shells. This is exactly what we see when we observe a neutral hydrogen map of the LMC, and we will confirm that later in this exercise when we create mock HI column density maps, as well as maps of other common and useful ions.\nOf course, this is just an example “slice” in the plane of the disk. In reality, we see the full, integrated column of gas along our line of sight, which is at an angle to the disk orientation. Let’s show that view instead…\n\n# density projection along the line of sight\nL = [-0.561,0.099,0.822] # vector normal to cutting plane\nnorth_vector = [0,0,1]\n\n# Plot the column density (projected density)  \nfield = (\"gas\",\"number_density\")\nproj = yt.OffAxisProjectionPlot(ds, L, field,center = (0,0,0), width=(20, 'kpc'))\nproj.set_cmap(field=field, cmap='cmr.eclipse')\nproj.set_colorbar_label(field, r\"Column Density (cm$^{-2}$)\")\nproj.set_zlim(field,1.E19, 5.E21)\nproj.annotate_timestamp()\nproj.show()\n\nyt : [INFO     ] 2023-09-11 17:00:25,200 xlim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:25,200 ylim = -30856775809623249649664.000000 30856775809623249649664.000000\nyt : [INFO     ] 2023-09-11 17:00:25,201 zlim = -92554999999999995019264.000000 92554999999999995019264.000000\nyt : [INFO     ] 2023-09-11 17:00:25,201 Making a fixed resolution buffer of (('gas', 'number_density')) 800 by 800"
  },
  {
    "objectID": "posts/post-with-code/index.html#towards-a-better-comparison-to-real-observations",
    "href": "posts/post-with-code/index.html#towards-a-better-comparison-to-real-observations",
    "title": "LMC Analysis: Part I",
    "section": "Towards a better comparison to real observations",
    "text": "Towards a better comparison to real observations\nSo far we’ve made a column density map along the line-of-sight to the LMC, which is a good start, but that is still not exactly what we get from observations.\n\nObservations are typically plotted in Right Ascension (RA), Declination (DEC) coordinates\nObservations never give us the full gas density…instead we obtain abundances of different ions, which exist at certain densities and temperatures\nIon abundances are obtained through e.g. absorption line spectroscopy. So what we ultimately want, to best compare to observations, are maps of various ion column densities and mock absorption lines through different sightlines.\n\nLet’s start by using the astropy package to convert from simulation coordinates to RA, DEC coordinates\n\n# Restrict our plot to just the galaxy (cells with an ISM tag &gt; 0.6)\ncut_data = dd.cut_region('(obj[\"ism \"] &gt; 0.6)')\n\nprj_fits = yt.FITSOffAxisProjection(ds,L,field,center = (0,0,0),width=(20, 'kpc'),data_source=cut_data)\nsky_center = [79.0,-68.68] # in degrees, what Jack told me to use\nsky_scale = (4123.71, \"arcsec/kpc\") # could also use a YTQuantity\nprj_fits.create_sky_wcs(sky_center, sky_scale, ctype=[\"RA---TAN\",\"DEC--TAN\"], replace_old_wcs=True)\nprj_fits.writeto(\"LMC_H.fits\",overwrite=True)\n\nyt : [INFO     ] 2023-09-11 17:00:46,633 Making a FITS image of field number_density\n\n\n\n# We'll plot images multiple times, so let's make this a function\n\n# Requires: file -- file name, e.g. \"LMC_H.fits\"\n# Requires: ion -- ion name, e.g. \"H\"\n# Requires: min_max = (min, max) of field value for colorbar = (1e19,5e21) by default\ndef plotFits(file,ion,min_max=(1e19,5e21)):\n    image_data = fits.getdata(file)\n    print(type(image_data))\n    print(image_data.shape)\n\n    vmin,vmax = min_max\n    fig = aplpy.FITSFigure(file)\n    fig.add_grid()\n    fig.show_colorscale(cmap=\"cmr.eclipse\",stretch = 'log', vmin=vmin, vmax = vmax)\n    fig.tick_labels.set_xposition(\"top\")\n    fig.ticks.set_xspacing(8.0)\n    fig.ticks.set_yspacing(8.0)\n    fig.add_colorbar()\n    fig.colorbar.set_axis_label_text(ion + r' Column Density (cm$^{-2}$)')\n \n    # fig.tick_labels.set_xformat('hh:mm')\n    fig.tick_labels.set_xformat('dd')\n    fig.tick_labels.set_yformat('dd')\n    # fig.set_theme('pretty')\n    #fig.colorbar.show(log_format=False)\n    fig.colorbar.set_font(size=20)\n\n\nplotFits(\"LMC_H.fits\", \"H\",min_max=(1e19,5e21))\n\n&lt;class 'numpy.ndarray'&gt;\n(512, 512)\n\n\n\n\n\nLet’s now separate out different ions instead of showing the full gas column density. Here, we use the Trident package, which assumes that the gas is in photoionization equilibrium (PIE) with the metagalactic UV background. I wrote a new radiative cooling / heating routine in the FLASH simulations that uses the same assumption, calculating cooling rates as a function of the evolving gas density, metallicity, and temperature. So this is a consistent assumption.\n\n# I've created and output a few relevant *tracers* with values in [0,1] from the FLASH simulations: metallicity and concentration of ISM (interstellar medium) matter\n# Trident needs the metallicity field to be called \"metallicity\", so do this here..\ndef _metallicity(field, data):\n    val = data['mtl ']\n    return val\n\n# add the new metallicity field and weight it by ISM concentration so we preferentially select the galaxy instead of the background\nds.add_field(('gas', 'metallicity'), function=_metallicity, units='dimensionless',sampling_type='cell', force_override=True)\n\n# Based on that metallicity and the PIE assumption, tell Trident to calculate HI, HII, and OVI abundances\n# Note: As of YT 4.0, these fields seem to be included without needing to add them with Trident. \ntrident.add_ion_fields(ds, ions=['H I', 'H II', 'Si II', 'Si III', 'Si IV', 'O VI'], ftype=\"gas\")\n\n# create all the projections, write them to FITS files for later use, and make initial mock images\n# this may take a few minutes\nprj_fits = yt.FITSOffAxisProjection(ds,L,'H_p0_number_density',center = (0,0,0),width=(20, 'kpc'),data_source=cut_data)\nprj_fits.create_sky_wcs(sky_center, sky_scale, ctype=[\"RA---TAN\",\"DEC--TAN\"], replace_old_wcs=True)\nprj_fits.writeto(\"LMC_HI.fits\", overwrite=True)\n\nprj_fits = yt.FITSOffAxisProjection(ds,L,'H_p1_number_density',center = (0,0,0),width=(20, 'kpc'),data_source=cut_data)\nprj_fits.create_sky_wcs(sky_center, sky_scale, ctype=[\"RA---TAN\",\"DEC--TAN\"], replace_old_wcs=True)\nprj_fits.writeto(\"LMC_HII.fits\", overwrite=True)\n\nyt : [INFO     ] 2023-09-11 17:01:05,755 Making a FITS image of field H_p0_number_density\nyt : [INFO     ] 2023-09-11 17:01:23,563 Making a FITS image of field H_p1_number_density\n\n\n\n# Make images\nplotFits(\"LMC_HI.fits\", \"H I\")\nplotFits(\"LMC_HII.fits\", \"H II\")\n\n&lt;class 'numpy.ndarray'&gt;\n(512, 512)\n&lt;class 'numpy.ndarray'&gt;\n(512, 512)\n\n\n\n\n\n\n\n\nHI probes neutral hydrogen, which is quite abundant in the LMC disk\nHII probes singly ionized hydrogen. The fact that there is a significant column of ionized hydrogen suggests that estimates of total LMC gas mass from just neutral hydrogen are underestimates; instead, this simulated LMC appears to have a diffuse halo of ionized gas surrounding the disk, in this case developed from ram pressure stripping and galactic outflows driven by supernovae."
  },
  {
    "objectID": "posts/post-with-code/index.html#mock-cos-halos-spectra",
    "href": "posts/post-with-code/index.html#mock-cos-halos-spectra",
    "title": "LMC Analysis: Part I",
    "section": "Mock COS-Halos spectra",
    "text": "Mock COS-Halos spectra\nFinally, observations rarely can produce a beautiful, full map of ion densities. Instead, we rely on absorption line spectroscopy along many lines of sight (rays) puncturing the LMC disk and pointed towards either background quasars (very bright objects) or bright stars in the LMC disk. Using Trident, we can create mock spectra according to the specifications of the COS-Halos spectrograph aboard HST.\nIn the following, we’ll use Trident to get Si II and Si III spectra along two rays probing the near-side of the LMC disk (the background light source is assumed to be a bright LMC star instead of a background quasar). We’ll compare spectral widths, which give a measure of the turbulent velocity dispersion, and then create velocity dispersion maps to make more sense of our spectra.\n\n# Somewhat boring stuff where I've modified the Trident plotting function to accept multiple rays on one plot\nfrom yt.funcs import \\\n    mylog\nimport numpy as np\nimport matplotlib.figure\nfrom matplotlib.backends.backend_agg import \\\n    FigureCanvasAgg\n \n\n# Define a helper unit to convert units\ndef kpc2codeunits(ds, kpc_array):\n    # A function which takes coordinates in kpc\n    # and returns a YTArray in code_length\n    KPC2CM = 1000*3.0856775809623245e+18\n    x = YTQuantity(kpc_array[0],'kpc').in_cgs()\n    y = YTQuantity(kpc_array[1],'kpc').in_cgs()\n    z = YTQuantity(kpc_array[2],'kpc').in_cgs()\n    pos = ds.arr([x, y, z],'code_length')\n    return pos\n\n# Trident function modified by Chad\ndef plot_spectrum_Chad(wavelength, flux, filename=\"spectrum.png\",\n    lambda_limits=None, flux_limits=None,\n    title=None, label=None, figsize=None, step=False,\n    stagger=0.2, features=None, axis_labels=None):\n    \"\"\"\n    Plot a spectrum or a collection of spectra and save to disk.\n \n     This function wraps some Matplotlib plotting functionality for\n     plotting spectra generated with the :class:`~trident.SpectrumGenerator`.\n     In its simplest form, it accepts a wavelength array consisting of\n     wavelength values and a corresponding flux array consisting of relative\n     flux values, and it plots them and saves to disk.\n \n     In addition, it can plot several spectra on the same axes simultaneously\n     by passing a list of arrays to the ``wavelength``, ``flux`` arguments\n     (and optionally to the ``label`` and ``step`` keywords).\n \n     Returns the Matplotlib Figure object for further processing.\n \n     **Parameters**\n \n     :wavelength: array of floats or list of arrays of floats\n \n         Wavelength values in angstroms.  Either as an array of floats in the\n         case of plotting a single spectrum, or as a list of arrays of floats\n         in the case of plotting several spectra on the same axes.\n \n     :flux: array of floats or list of arrays of floats\n \n         Relative flux values (from 0 to 1) corresponding to wavelength array.\n         Either as an array of floats in the case of plotting a single\n         spectrum, or as a list of arrays of floats in the case of plotting\n         several spectra on the same axes.\n \n   :filename: string, optional\n \n         Output filename of the plotted spectrum.  Will be a png file.\n         Default: 'spectrum.png'\n \n     :lambda_limits: tuple or list of floats, optional\n \n         The minimum and maximum of the wavelength range (x-axis) for the plot\n         in angstroms.  If specified as None, will use whole lambda range\n         of spectrum. Example: (1200, 1400) for 1200-1400 Angstroms\n         Default: None\n \n     :flux_limits: tuple or list of floats, optional\n \n         The minimum and maximum of the flux range (y-axis) for the plot.\n         If specified as None, limits are automatically from\n         [0, 1.1*max(flux)]. Example: (0, 1) for normal flux range before\n         postprocessing.\n         Default: None\n \n     :step: boolean or list of booleans, optional\n \n         Plot the spectrum as a series of step functions.  Appropriate for\n         plotting processed and noisy data.  Use a list of booleans when\n         plotting multiple spectra, where each boolean corresponds to the entry\n         in the ``wavelength`` and ``flux`` lists.\n \n     :title: string, optional\n \n         Optional title for plot\n         Default: None\n \n     :label: string or list of strings, optional\n \n         Label for each spectrum to be plotted. Useful if plotting multiple\n         spectra simultaneously.  Will automatically trigger a legend to be\n         generated.\n         Default: None\n \n     :stagger: float, optional\n \n         If plotting multiple spectra on the same axes, do we offset them in\n         the y direction?  If set to None, no.  If set to a float, stagger them\n         by the flux value specified by this parameter.\n \n    :features: dict, optional\n \n         Include vertical lines with labels to represent certain spectral\n         features.  Each entry in the dictionary consists of a key string to\n         be overplot and the value float as to where in wavelength space it\n         will be plot as a vertical line with the corresponding label.\n \n         Example: features={'Ly a' : 1216, 'Ly b' : 1026}\n \n         Default: None\n \n     :axis_labels: tuple of strings, optional\n \n         Optionally set the axis labels directly.  If set to None, defaults to\n         ('Wavelength [$\\\\rm\\\\AA$]', 'Relative Flux').\n         Default: None\n \n     **Returns**\n \n     Matplotlib Figure object for further processing\n \n     **Example**\n \n     Plot a flat spectrum\n \n     &gt;&gt;&gt; import numpy as np\n     &gt;&gt;&gt; import trident\n     &gt;&gt;&gt; wavelength = np.arange(1200, 1400)\n     &gt;&gt;&gt; flux = np.ones(len(wavelength))\n     &gt;&gt;&gt; trident.plot_spectrum(wavelength, flux)\n\n     Generate a one-zone ray, create a Lyman alpha spectrum from it, and add\n     gaussian noise to it.  Plot both the raw spectrum and the noisy spectrum\n     on top of each other.\n \n     &gt;&gt;&gt; import trident\n     &gt;&gt;&gt; ray = trident.make_onezone_ray(column_densities={'H_p0_number_density':1e21})\n     &gt;&gt;&gt; sg_final = trident.SpectrumGenerator(lambda_min=1200, lambda_max=1300,         dlambda=0.5)\n     &gt;&gt;&gt; sg_final.make_spectrum(ray, lines=['Ly a'])\n     &gt;&gt;&gt; sg_final.save_spectrum('spec_raw.h5')\n     &gt;&gt;&gt; sg_final.add_gaussian_noise(10)\n     &gt;&gt;&gt; sg_raw = trident.load_spectrum('spec_raw.h5')\n     &gt;&gt;&gt; trident.plot_spectrum([sg_raw.lambda_field, sg_final.lambda_field],\n     ... [sg_raw.flux_field, sg_final.flux_field], stagger=0, step=[False, True],\n     ... label=['Raw', 'Noisy'], filename='raw_and_noise.png')\n     \"\"\"  \n        \n    myfsize = 20\n  \n        # number of rows and columns\n    n_rows = 1\n    n_columns = 1\n \n    # blank space between edge of figure and active plot area\n    top_buffer = 0.07\n    bottom_buffer = 0.15\n    left_buffer = 0.06\n    right_buffer = 0.03\n \n    # blank space between plots\n    hor_buffer = 0.05\n    vert_buffer = 0.05\n \n    # calculate the height and width of each panel\n    panel_width = ((1.0 - left_buffer - right_buffer -\n                    ((n_columns-1)*hor_buffer)) / n_columns)\n    panel_height = ((1.0 - top_buffer - bottom_buffer -\n                     ((n_rows-1)*vert_buffer)) / n_rows)\n \n    # create a figure (figsize is in inches)\n    if figsize is None:\n        figsize = (12, 4)\n    figure = matplotlib.figure.Figure(figsize=figsize, frameon=True)\n\n    # get the row and column number\n    my_row = 0\n    my_column = 0\n\n    # calculate the position of the bottom, left corner of this plot\n    left_side = left_buffer + (my_column * panel_width) + \\\n                my_column * hor_buffer\n    top_side = 1.0 - (top_buffer + (my_row * panel_height) + \\\n               my_row * vert_buffer)\n    bottom_side = top_side - panel_height\n     # create an axes object on which we will make the plot\n    my_axes = figure.add_axes((left_side, bottom_side, panel_width, panel_height))\n\n    # Are we overplotting several spectra?  or just one?\n    if not (isinstance(wavelength, list) and isinstance(flux, list)):\n        wavelengths = [wavelength]\n        fluxs = [flux]\n        labels = [label]\n        steps = [step]\n    else:\n        wavelengths = wavelength\n        fluxs = flux\n        if label is not None:\n            labels = label\n        else:\n            labels = [None]*len(fluxs)\n        if step is not None:\n            steps = step\n        else:\n            steps = [None]*len(fluxs)\n\n    # A running maximum of flux for use in ylim scaling in final plot\n    max_flux = 0.\n\n    for i, (wavelength, flux) in enumerate(zip(wavelengths, fluxs)):\n\n        # Do we stagger the fluxes?\n        if stagger is not None:\n            flux -= stagger * i\n\n        # Do we include labels and a legend?\n        if steps[i]:\n            my_axes.step(wavelength, flux, label=labels[i])\n        else:\n            my_axes.plot(wavelength, flux, label=labels[i])\n\n        new_max_flux = np.max(flux)\n        if new_max_flux &gt; max_flux:\n            max_flux = new_max_flux\n                \n        # Return the fluxes to their normal values\n        # if they've been staggered\n        if stagger is not None:\n            flux += stagger * i\n\n    # Do we include a title?\n    if title is not None:\n        my_axes.set_title(title)\n\n    if lambda_limits is None:\n        lambda_limits = (wavelength.min(), wavelength.max())\n    my_axes.set_xlim(lambda_limits[0], lambda_limits[1])\n\n    if flux_limits is None:\n        flux_limits = (0, 1.1*max_flux)\n    my_axes.set_ylim(flux_limits[0], flux_limits[1])\n    if axis_labels is None:\n        axis_labels = ('Wavelength [$\\\\rm\\\\AA$]', 'Relative Flux')\n    my_axes.xaxis.set_label_text(axis_labels[0],fontsize=myfsize)\n    my_axes.yaxis.set_label_text(axis_labels[1],fontsize=myfsize)\n\n    # Don't let the x-axis switch to offset values for tick labels\n    my_axes.get_xaxis().get_major_formatter().set_useOffset(False)\n\n    for tick in my_axes.xaxis.get_major_ticks():\n                        tick.label.set_fontsize(14)\n    for tick in my_axes.yaxis.get_major_ticks():\n                        tick.label.set_fontsize(14)\n\n    if label is not None: my_axes.legend(fontsize=14)\n\n    # Overplot the relevant features on the plot\n    if features is not None:\n        for feature in features:\n            label = feature\n            wavelength = features[feature]\n            # Draw line\n            my_axes.plot([wavelength, wavelength], flux_limits, '--', color='k')\n            # Write text\n            text_location = flux_limits[1] - 0.05*(flux_limits[1] - flux_limits[0])\n            my_axes.text(wavelength, text_location, label,\n                   # horizontalalignment='left',\n                    horizontalalignment='right',\n                   # verticalalignment='top', rotation='horizontal',fontsize=14)\n                    verticalalignment='top', rotation='vertical',fontsize=12)\n\n    mylog.info(\"Writing spectrum plot to png file: %s\" % filename)\n    canvas = FigureCanvasAgg(figure)\n    canvas.print_figure(filename)\n    return figure\n\n\n# If not already created, create a directory called LightRays to store the ray.h5 files in\nimport os\n  \n# Directory\ndirectory = \"LightRays\"\n  \nif (os.path.exists(directory)==False):\n    os.mkdir(directory)\n    print(\"Directory '% s' created\" % directory)\n\n\n# Let's probe two different regions of the disk. The first ray will puncture close to the center, while another ray will puncture further out\nstart_coords1  = [-3.0,-3.0,0.0]\nend_coords1 = [-3.0-0.561*10.0,-3.0-0.099*10.0,-0.822*10.0]\nray_start1 = kpc2codeunits(ds, start_coords1)\nray_end1 = kpc2codeunits(ds, end_coords1)\nrayName1 = 'ray1'\nline_list='all' # let Trident know about all the absorption lines\n\n \nstart_coords2   = [3.0,7.0,0.0]\nend_coords2 = [3.0-0.561*10.0,7.0-0.099*10.0,-0.822*10.0]\nray_start2 = kpc2codeunits(ds, start_coords2)\nray_end2 = kpc2codeunits(ds, end_coords2)\nrayName2 = 'ray2'\nline_list='all'\n\nray1 = trident.make_simple_ray(ds,\n                               start_position=ray_start1,\n                               end_position=ray_end1,\n                               data_filename=rayName1+'.h5',\n                               lines=line_list,\n                               ftype='gas')\n\nray2 = trident.make_simple_ray(ds,\n                               start_position=ray_start2,\n                               end_position=ray_end2,\n                               data_filename=rayName2+'.h5',\n                               lines=line_list,\n                               ftype='gas')\n\n# Show where the light rays start and end\nq = yt.ProjectionPlot(ds, 1, 'density', weight_field='ism ')\nq.annotate_timestamp()\nq.annotate_ray(ray1, arrow=True)\nq.annotate_ray(ray2, arrow=True)\nq.set_cmap('density', 'cmr.eclipse')\nq.set_zlim('density', 1e-28, 1e-24)\nq.show()\n\nyt : [INFO     ] 2023-09-11 17:01:27,251 Getting segment at z = 0.0: [-0.05000828 -0.05000828  0.        ] unitary to [-0.14352376 -0.06651101 -0.13702269] unitary.\nyt : [INFO     ] 2023-09-11 17:01:27,253 Getting subsegment: [-0.05000828 -0.05000828  0.        ] unitary to [-0.14352376 -0.06651101 -0.13702269] unitary.\nyt : [INFO     ] 2023-09-11 17:01:27,321 Saving field data to yt dataset: ray1.h5.\nyt : [INFO     ] 2023-09-11 17:01:27,485 Parameters: current_time              = 3.156010944496386e+16 code_time\nyt : [INFO     ] 2023-09-11 17:01:27,485 Parameters: domain_dimensions         = [1 1 1]\nyt : [INFO     ] 2023-09-11 17:01:27,485 Parameters: domain_left_edge          = [-6.171e+22 -6.171e+22 -6.171e+22] code_length\nyt : [INFO     ] 2023-09-11 17:01:27,486 Parameters: domain_right_edge         = [1.234e+23 1.234e+23 1.234e+23] code_length\nyt : [INFO     ] 2023-09-11 17:01:27,486 Parameters: cosmological_simulation   = 0\nyt : [INFO     ] 2023-09-11 17:01:27,494 Getting segment at z = 0.0: [0.05000828 0.11668599 0.        ] unitary to [-0.0435072   0.10018325 -0.13702269] unitary.\nyt : [INFO     ] 2023-09-11 17:01:27,495 Getting subsegment: [0.05000828 0.11668599 0.        ] unitary to [-0.0435072   0.10018325 -0.13702269] unitary.\nyt : [INFO     ] 2023-09-11 17:01:27,546 Saving field data to yt dataset: ray2.h5.\nyt : [INFO     ] 2023-09-11 17:01:27,690 Parameters: current_time              = 3.156010944496386e+16 code_time\nyt : [INFO     ] 2023-09-11 17:01:27,690 Parameters: domain_dimensions         = [1 1 1]\nyt : [INFO     ] 2023-09-11 17:01:27,691 Parameters: domain_left_edge          = [-6.171e+22 -6.171e+22 -6.171e+22] code_length\nyt : [INFO     ] 2023-09-11 17:01:27,691 Parameters: domain_right_edge         = [1.234e+23 1.234e+23 1.234e+23] code_length\nyt : [INFO     ] 2023-09-11 17:01:27,692 Parameters: cosmological_simulation   = 0\nyt : [INFO     ] 2023-09-11 17:01:29,124 Projection completed\nyt : [INFO     ] 2023-09-11 17:01:29,129 xlim = -61709999999999992135680.000000 123399999999999997902848.000000\nyt : [INFO     ] 2023-09-11 17:01:29,130 ylim = -61709999999999992135680.000000 123399999999999997902848.000000\nyt : [INFO     ] 2023-09-11 17:01:29,140 xlim = -61709999999999992135680.000000 123399999999999997902848.000000\nyt : [INFO     ] 2023-09-11 17:01:29,142 ylim = -61709999999999992135680.000000 123399999999999997902848.000000\nyt : [INFO     ] 2023-09-11 17:01:29,147 Making a fixed resolution buffer of (('gas', 'density')) 800 by 800\n\n\n\n\n\nNow let’s generate a spectrum. Let’s focus on wavelengths between 1150 and 1300 angstroms, where we’ll find Si II and Si III lines\n\nlambda_min,lambda_max = 1150, 1300\nsg1 = trident.SpectrumGenerator(lambda_min=lambda_min, lambda_max=lambda_max, dlambda=0.01)\nsg1.make_spectrum(ray1, lines='all', use_peculiar_velocity=True,\n                  store_observables=True)\nsg1.add_milky_way_foreground()\nsg1.apply_lsf(filename='avg_COS.txt')\nsg1.add_gaussian_noise(30)\nsg1.save_spectrum('LightRays/spec_all_ray1.h5')\n\nsg2 = trident.SpectrumGenerator(lambda_min=lambda_min, lambda_max=lambda_max, dlambda=0.01)\nsg2.make_spectrum(ray2, lines='all', use_peculiar_velocity=True,\n                 store_observables=True)\nsg2.add_milky_way_foreground()\nsg2.apply_lsf(filename='avg_COS.txt')\nsg2.add_gaussian_noise(30)\nsg2.save_spectrum('LightRays/spec_all_ray2.h5')\n\nyt : [INFO     ] 2023-09-11 17:01:29,744 Setting instrument to Custom\nyt : [INFO     ] 2023-09-11 17:01:29,811 Allocating for 107 particles\nyt : [INFO     ] 2023-09-11 17:01:29,916 Using all 213 available lines in 'lines.txt'.\nyt : [INFO     ] 2023-09-11 17:01:29,920 Creating C_p0_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,929 Creating C_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,933 Creating C_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,938 Creating C_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,944 Creating N_p0_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,955 Creating N_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,963 Creating N_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,967 Creating N_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,971 Creating N_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,975 Creating O_p0_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,984 Creating O_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:29,992 Creating O_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,000 Creating O_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,005 Creating O_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,009 Creating Ne_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,018 Creating Ne_p5_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,026 Creating Ne_p6_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,032 Creating Ne_p7_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,036 Creating Na_p8_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,044 Creating Mg_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,054 Creating Mg_p9_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,062 Creating Al_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,070 Creating Al_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,078 Creating Si_p11_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,090 Creating P_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,099 Creating P_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,105 Creating S_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,115 Creating S_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,125 Creating S_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,133 Creating S_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,138 Creating S_p5_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,142 Creating S_p13_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,149 Creating Ar_p0_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,160 Creating Ar_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,171 Creating Ar_p6_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,182 Creating Ca_p9_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,193 Creating Fe_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:30,209 Creating spectrum\nAdding line - Ly a [1215.670000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly a [1215.670000 A]:   7%|▋         | 8/107 [00:00&lt;00:01, 74.84it/s]Adding line - Ly a [1215.670000 A]:  18%|█▊        | 19/107 [00:00&lt;00:00, 92.84it/s]Adding line - Ly a [1215.670000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 414.34it/s]\nAdding line - Ly b [1025.722200 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly b [1025.722200 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 3671.74it/s]\nAdding line - Ly c [972.536740 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly c [972.536740 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6324.99it/s]\nAdding line - Ly d [949.742980 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly d [949.742980 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7285.72it/s]\nAdding line - Ly e [937.803400 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly e [937.803400 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7507.66it/s]\nAdding line - Ly 6 [930.748200 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 6 [930.748200 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7973.53it/s]\nAdding line - Ly 7 [926.225640 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 7 [926.225640 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7329.07it/s]\nAdding line - Ly 8 [923.150300 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 8 [923.150300 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7294.68it/s]\nAdding line - Ly 9 [920.963026 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 9 [920.963026 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7226.62it/s]\nAdding line - Ly 10 [919.351351 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 10 [919.351351 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7722.04it/s]\nAdding line - Ly 11 [918.129312 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 11 [918.129312 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7101.61it/s]\nAdding line - Ly 12 [917.180525 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 12 [917.180525 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7492.73it/s]\nAdding line - Ly 13 [916.429085 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 13 [916.429085 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7132.71it/s]\nAdding line - Ly 14 [915.823759 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 14 [915.823759 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7680.68it/s]\nAdding line - Ly 15 [915.328939 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 15 [915.328939 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7539.62it/s]\nAdding line - Ly 16 [914.919249 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 16 [914.919249 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8115.74it/s]\nAdding line - Ly 17 [914.576207 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 17 [914.576207 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7962.82it/s]\nAdding line - Ly 18 [914.286092 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 18 [914.286092 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7423.30it/s]\nAdding line - Ly 19 [914.038542 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 19 [914.038542 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7883.47it/s]\nAdding line - Ly 20 [913.825614 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 20 [913.825614 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8101.98it/s]\nAdding line - Ly 21 [913.641137 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 21 [913.641137 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7979.69it/s]\nAdding line - Ly 22 [913.480256 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 22 [913.480256 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7436.09it/s]\nAdding line - Ly 23 [913.339110 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 23 [913.339110 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7951.43it/s]\nAdding line - Ly 24 [913.214596 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 24 [913.214596 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6822.94it/s]\nAdding line - Ly 25 [913.104199 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 25 [913.104199 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7854.22it/s]\nAdding line - Ly 26 [913.005863 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 26 [913.005863 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6600.20it/s]\nAdding line - Ly 27 [912.917891 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 27 [912.917891 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8082.25it/s]\nAdding line - Ly 28 [912.838877 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 28 [912.838877 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7865.76it/s]\nAdding line - Ly 29 [912.767643 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 29 [912.767643 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6058.82it/s]\nAdding line - Ly 30 [912.703200 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 30 [912.703200 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8505.27it/s]\nAdding line - Ly 31 [912.644712 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 31 [912.644712 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7950.58it/s]\nAdding line - Ly 32 [912.591467 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 32 [912.591467 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8277.56it/s]\nAdding line - Ly 33 [912.542856 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 33 [912.542856 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6899.17it/s]\nAdding line - Ly 34 [912.498356 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 34 [912.498356 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7573.78it/s]\nAdding line - Ly 35 [912.457516 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 35 [912.457516 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8566.40it/s]\nAdding line - Ly 36 [912.419946 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 36 [912.419946 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8471.89it/s]\nAdding line - Ly 37 [912.385306 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 37 [912.385306 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7568.63it/s]\nAdding line - Ly 38 [912.353298 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 38 [912.353298 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7851.87it/s]\nAdding line - Ly 39 [912.323663 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly 39 [912.323663 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8534.66it/s]\nAdding line - C I 1657 [1656.929000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1657 [1656.929000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 9104.98it/s]\nAdding line - C I 1560 [1560.309000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1560 [1560.309000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11324.70it/s]\nAdding line - C I 1329 [1328.834000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1329 [1328.834000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11522.81it/s]\nAdding line - C I 1280 [1280.135000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1280 [1280.135000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 10584.36it/s]\nAdding line - C I 1277 [1277.245000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1277 [1277.245000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8449.67it/s]\nAdding line - C I 1261 [1260.735000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1261 [1260.735000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 12506.93it/s]\nAdding line - C I 1194 [1193.995000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1194 [1193.995000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 14155.96it/s]\nAdding line - C I 1193 [1193.031000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1193 [1193.031000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 12962.74it/s]\nAdding line - C I 1189 [1188.833000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1189 [1188.833000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 14293.40it/s]\nAdding line - C I 1158 [1157.910000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C I 1158 [1157.910000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 14118.20it/s]\nAdding line - C II* 1336 [1335.663000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C II* 1336 [1335.663000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 9639.99it/s]\nAdding line - C II 1335 [1334.532000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C II 1335 [1334.532000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4739.73it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,251 26 out of 107 line components are unresolved.\nAdding line - C II* 1037 [1037.018000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C II* 1037 [1037.018000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 2311.85it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,299 27 out of 107 line components are unresolved.\nAdding line - C II 1036 [1036.337000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C II 1036 [1036.337000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 2812.80it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,338 33 out of 107 line components are unresolved.\nAdding line - C II 904 [903.962000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C II 904 [903.962000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 1426.00it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,418 31 out of 107 line components are unresolved.\nAdding line - C III 977 [977.020000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C III 977 [977.020000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 3237.31it/s]\nAdding line - C IV 1551 [1550.772000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C IV 1551 [1550.772000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 13299.72it/s]\nAdding line - C IV 1548 [1548.187000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - C IV 1548 [1548.187000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 12426.87it/s]\nAdding line - N I 1201 [1200.710000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 1201 [1200.710000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6302.31it/s]\nAdding line - N I 1200 [1200.223000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 1200 [1200.223000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6956.82it/s]\nAdding line - N I 1200 [1199.550000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 1200 [1199.550000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15856.35it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,523 3 out of 107 line components are unresolved.\nAdding line - N I 1135 [1134.980000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 1135 [1134.980000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 12399.15it/s]\nAdding line - N I 1134 [1134.415000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 1134 [1134.415000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 13901.45it/s]\nAdding line - N I 1134 [1134.165000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 1134 [1134.165000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 13897.98it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,552 33 out of 107 line components are unresolved.\nAdding line - N I 965 [965.041000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 965 [965.041000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15501.96it/s]\nAdding line - N I 965 [964.626000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 965 [964.626000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 14550.69it/s]\nAdding line - N I 964 [963.990000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 964 [963.990000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 14730.51it/s]\nAdding line - N I 954 [954.104000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 954 [954.104000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 16843.96it/s]\nAdding line - N I 954 [953.970000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 954 [953.970000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 10314.26it/s]\nAdding line - N I 954 [953.655000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 954 [953.655000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8772.62it/s]\nAdding line - N I 953 [953.415000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 953 [953.415000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11847.68it/s]\nAdding line - N I 952 [952.415000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 952 [952.415000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 16246.89it/s]\nAdding line - N I 952 [952.303000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N I 952 [952.303000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 17359.58it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,641 30 out of 107 line components are unresolved.\nAdding line - N II 1084 [1083.990000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N II 1084 [1083.990000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 5882.07it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,661 33 out of 107 line components are unresolved.\nAdding line - N II 916 [915.612000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N II 916 [915.612000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4340.70it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,689 32 out of 107 line components are unresolved.\nAdding line - N III 990 [989.799000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N III 990 [989.799000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 13308.08it/s]\nyt : [INFO     ] 2023-09-11 17:01:31,702 33 out of 107 line components are unresolved.\nAdding line - N IV 765 [765.147000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N IV 765 [765.147000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19524.67it/s]\nAdding line - N V 1243 [1242.804000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N V 1243 [1242.804000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20420.55it/s]\nAdding line - N V 1239 [1238.821000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - N V 1239 [1238.821000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20221.79it/s]\nAdding line - O I* 1306 [1306.029000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I* 1306 [1306.029000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8040.73it/s]\nAdding line - O I* 1305 [1304.858000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I* 1305 [1304.858000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7529.02it/s]\nAdding line - O I 1302 [1302.168000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 1302 [1302.168000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6904.20it/s]\nAdding line - O I 1039 [1039.230000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 1039 [1039.230000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8580.45it/s]\nAdding line - O I 989 [988.773000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 989 [988.773000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4992.21it/s]\nAdding line - O I 989 [988.655000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 989 [988.655000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11328.45it/s]\nAdding line - O I 976 [976.448000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 976 [976.448000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15078.21it/s]\nAdding line - O I 951 [950.885000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 951 [950.885000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 13838.28it/s]\nAdding line - O I 937 [936.629000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 937 [936.629000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 16990.07it/s]\nAdding line - O I 930 [929.517000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 930 [929.517000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18206.98it/s]\nAdding line - O I 925 [924.950000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 925 [924.950000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 17756.15it/s]\nAdding line - O I 922 [922.008000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O I 922 [922.008000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8299.35it/s]\nAdding line - O II 834 [834.465400 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O II 834 [834.465400 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 3024.83it/s]\nAdding line - O II 833 [833.330300 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O II 833 [833.330300 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 3137.68it/s]\nAdding line - O II 833 [832.758300 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O II 833 [832.758300 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4023.68it/s]\nAdding line - O III* 835 [835.289000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O III* 835 [835.289000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11612.80it/s]\nAdding line - O III* 835 [835.289000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O III* 835 [835.289000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15319.81it/s]\nAdding line - O III 833 [832.929000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O III 833 [832.929000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15212.35it/s]\nAdding line - O III* 703 [702.838000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O III* 703 [702.838000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 16270.68it/s]\nAdding line - O III 702 [702.337000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O III 702 [702.337000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15966.25it/s]\nAdding line - O IV* 790 [790.199000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O IV* 790 [790.199000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18914.96it/s]\nAdding line - O IV 788 [787.710000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O IV 788 [787.710000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19583.15it/s]\nAdding line - O IV* 610 [609.829000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O IV* 610 [609.829000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19498.98it/s]\nAdding line - O IV 608 [608.397000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O IV 608 [608.397000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19033.19it/s]\nAdding line - O IV* 555 [554.513000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O IV* 555 [554.513000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18889.25it/s]\nAdding line - O IV 554 [554.076000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O IV 554 [554.076000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 17737.02it/s]\nAdding line - O IV 553 [553.329000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O IV 553 [553.329000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 17963.48it/s]\nAdding line - O V 630 [629.732000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O V 630 [629.732000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19435.90it/s]\nAdding line - O VI 1038 [1037.613000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O VI 1038 [1037.613000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15885.24it/s]\nAdding line - O VI 1032 [1031.912000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - O VI 1032 [1031.912000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11943.81it/s]\nAdding line - Ne V* 572 [572.335000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ne V* 572 [572.335000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18447.98it/s]\nAdding line - Ne V* 570 [569.828000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ne V* 570 [569.828000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18858.00it/s]\nAdding line - Ne V 568 [568.424000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ne V 568 [568.424000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18652.30it/s]\nAdding line - Ne VI* 563 [562.805000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ne VI* 563 [562.805000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 16560.37it/s]\nAdding line - Ne VI 559 [558.603000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ne VI 559 [558.603000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 16768.99it/s]\nAdding line - Ne VII 465 [465.221000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ne VII 465 [465.221000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18483.26it/s]\nAdding line - Ne VIII 780 [780.324000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ne VIII 780 [780.324000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 14295.70it/s]\nAdding line - Ne VIII 770 [770.409000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ne VIII 770 [770.409000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 12009.95it/s]\nAdding line - Na IX 694 [694.150000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Na IX 694 [694.150000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20650.08it/s]\nAdding line - Na IX 682 [681.720000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Na IX 682 [681.720000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 21873.28it/s]\nAdding line - Mg II 1240 [1240.394700 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Mg II 1240 [1240.394700 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11137.18it/s]\nAdding line - Mg II 1240 [1239.925300 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Mg II 1240 [1239.925300 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11451.88it/s]\nAdding line - Mg X 625 [624.941000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Mg X 625 [624.941000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20731.93it/s]\nAdding line - Mg X 610 [609.793000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Mg X 610 [609.793000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20159.44it/s]\nAdding line - Al II 1671 [1670.787400 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Al II 1671 [1670.787400 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4413.00it/s]\nAdding line - Al III 1863 [1862.789500 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Al III 1863 [1862.789500 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11270.72it/s]\nAdding line - Al III 1855 [1854.716400 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Al III 1855 [1854.716400 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11168.51it/s]\nAdding line - Si II* 1817 [1816.928000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II* 1817 [1816.928000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15429.33it/s]\nAdding line - Si II 1808 [1808.013000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II 1808 [1808.013000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15465.83it/s]\nAdding line - Si II* 1309 [1309.276000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II* 1309 [1309.276000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4128.18it/s]\nAdding line - Si II 1304 [1304.370000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II 1304 [1304.370000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 1189.90it/s]\nAdding line - Si II* 1265 [1264.738000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II* 1265 [1264.738000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 1642.04it/s]\nAdding line - Si II 1260 [1260.422000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II 1260 [1260.422000 A]:  13%|█▎        | 14/107 [00:00&lt;00:00, 132.94it/s]Adding line - Si II 1260 [1260.422000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 582.69it/s]\nAdding line - Si II* 1197 [1197.394000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II* 1197 [1197.394000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 1743.90it/s]\nAdding line - Si II* 1194 [1194.500000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II* 1194 [1194.500000 A]:  17%|█▋        | 18/107 [00:00&lt;00:00, 177.91it/s]Adding line - Si II* 1194 [1194.500000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 733.62it/s]\nAdding line - Si II 1193 [1193.290000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II 1193 [1193.290000 A]:  23%|██▎       | 25/107 [00:00&lt;00:00, 243.90it/s]Adding line - Si II 1193 [1193.290000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 900.73it/s]\nAdding line - Si II 1190 [1190.416000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II 1190 [1190.416000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 1815.91it/s]\nAdding line - Si II* 1024 [1023.700000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II* 1024 [1023.700000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 12683.90it/s]\nAdding line - Si II 1021 [1020.699000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II 1021 [1020.699000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 13856.82it/s]\nAdding line - Si II* 993 [992.683000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II* 993 [992.683000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4746.76it/s]\nAdding line - Si II 990 [989.873000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si II 990 [989.873000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4637.68it/s]\nAdding line - Si III 1206 [1206.500000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si III 1206 [1206.500000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 3666.71it/s]\nyt : [INFO     ] 2023-09-11 17:01:33,181 32 out of 107 line components are unresolved.\nAdding line - Si IV 1403 [1402.770000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si IV 1403 [1402.770000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11605.23it/s]\nyt : [INFO     ] 2023-09-11 17:01:33,194 33 out of 107 line components are unresolved.\nAdding line - Si XII 521 [520.665000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si XII 521 [520.665000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 22853.72it/s]\nAdding line - Si XII 499 [499.406000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si XII 499 [499.406000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 22433.96it/s]\nAdding line - P IV 951 [950.657000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - P IV 951 [950.657000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20109.29it/s]\nAdding line - P V 1128 [1128.008000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - P V 1128 [1128.008000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19438.45it/s]\nAdding line - P V 1118 [1117.977000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - P V 1118 [1117.977000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19541.83it/s]\nAdding line - S II 1260 [1259.519000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S II 1260 [1259.519000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8435.40it/s]\nAdding line - S II 1254 [1253.811000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S II 1254 [1253.811000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 9899.94it/s]\nAdding line - S II 1251 [1250.584000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S II 1251 [1250.584000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 9373.93it/s]\nAdding line - S II 913 [912.736000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S II 913 [912.736000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7077.19it/s]\nAdding line - S II 910 [910.485000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S II 910 [910.485000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6144.23it/s]\nAdding line - S II 907 [906.876000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S II 907 [906.876000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 5596.56it/s]\nAdding line - S II 766 [765.684000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S II 766 [765.684000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 2192.43it/s]\nAdding line - S II 764 [764.416000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S II 764 [764.416000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 2334.45it/s]\nAdding line - S II 764 [763.656000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S II 764 [763.656000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 3055.46it/s]\nAdding line - S III* 1201 [1200.966000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 1201 [1200.966000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 9538.44it/s]\nAdding line - S III* 1194 [1194.058000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 1194 [1194.058000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 10200.90it/s]\nAdding line - S III 1190 [1190.203000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III 1190 [1190.203000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 9360.51it/s]\nAdding line - S III* 1021 [1021.323000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 1021 [1021.323000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 17311.59it/s]\nAdding line - S III* 1021 [1021.108000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 1021 [1021.108000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18698.58it/s]\nAdding line - S III* 1016 [1015.779000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 1016 [1015.779000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19259.10it/s]\nAdding line - S III* 1016 [1015.567000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 1016 [1015.567000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18134.20it/s]\nAdding line - S III* 1016 [1015.502000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 1016 [1015.502000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18804.56it/s]\nAdding line - S III 1012 [1012.495000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III 1012 [1012.495000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 17497.59it/s]\nAdding line - S III* 729 [728.685000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 729 [728.685000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7173.80it/s]\nAdding line - S III* 726 [725.858000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 726 [725.858000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7765.06it/s]\nAdding line - S III 724 [724.288000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III 724 [724.288000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 9475.22it/s]\nAdding line - S III* 703 [702.779000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 703 [702.779000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6062.29it/s]\nAdding line - S III* 700 [700.288000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 700 [700.288000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6550.41it/s]\nAdding line - S III* 700 [700.150000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 700 [700.150000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7906.32it/s]\nAdding line - S III 699 [698.727000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III 699 [698.727000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 6460.28it/s]\nAdding line - S III* 681 [680.925000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 681 [680.925000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8657.82it/s]\nAdding line - S III* 681 [680.677000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 681 [680.677000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4411.73it/s]\nAdding line - S III* 678 [678.456000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III* 678 [678.456000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 5650.40it/s]\nAdding line - S III 678 [677.729000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S III 678 [677.729000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 4192.41it/s]\nAdding line - S IV* 1073 [1072.973000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S IV* 1073 [1072.973000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 17039.56it/s]\nAdding line - S IV* 816 [815.941000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S IV* 816 [815.941000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 17980.92it/s]\nAdding line - S IV 810 [809.656000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S IV 810 [809.656000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15282.95it/s]\nAdding line - S IV* 754 [753.760000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S IV* 754 [753.760000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19604.74it/s]\nAdding line - S IV* 750 [750.221000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S IV* 750 [750.221000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18868.40it/s]\nAdding line - S IV 748 [748.393000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S IV 748 [748.393000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20451.55it/s]\nAdding line - S IV 745 [744.904000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S IV 745 [744.904000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20702.97it/s]\nAdding line - S IV 657 [657.319000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S IV 657 [657.319000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19200.04it/s]\nAdding line - S V 786 [786.468000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S V 786 [786.468000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19811.78it/s]\nAdding line - S VI 945 [944.523000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S VI 945 [944.523000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18764.88it/s]\nAdding line - S VI 933 [933.378000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S VI 933 [933.378000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 18573.60it/s]\nAdding line - S XIV 446 [445.700000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S XIV 446 [445.700000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 37062.04it/s]\nAdding line - S XIV 418 [417.660000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - S XIV 418 [417.660000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 38910.92it/s]\nAdding line - Ar I 1067 [1066.660000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ar I 1067 [1066.660000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 24708.03it/s]\nAdding line - Ar I 1048 [1048.220000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ar I 1048 [1048.220000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 15743.49it/s]\nAdding line - Ar II* 726 [725.548530 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ar II* 726 [725.548530 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 12748.28it/s]\nAdding line - Ar II 723 [723.360560 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ar II 723 [723.360560 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 11844.84it/s]\nAdding line - Ar II 718 [718.089852 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ar II 718 [718.089852 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 22395.54it/s]\nAdding line - Ar VII 586 [585.748000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ar VII 586 [585.748000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20885.81it/s]\nAdding line - Ca X 574 [574.010000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ca X 574 [574.010000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 19229.94it/s]\nAdding line - Ca X 558 [557.765000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ca X 558 [557.765000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 21233.94it/s]\nAdding line - Fe II 1608 [1608.450830 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1608 [1608.450830 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 5404.05it/s]\nAdding line - Fe II 1143 [1143.225730 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1143 [1143.225730 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 13195.51it/s]\nAdding line - Fe II 1127 [1127.098400 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1127 [1127.098400 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 25317.25it/s]\nAdding line - Fe II 1125 [1125.447630 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1125 [1125.447630 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 12492.52it/s]\nAdding line - Fe II 1122 [1121.974710 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1122 [1121.974710 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 8069.48it/s]\nAdding line - Fe II 1112 [1112.048320 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1112 [1112.048320 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 21311.29it/s]\nAdding line - Fe II 1097 [1096.876870 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1097 [1096.876870 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 9025.14it/s]\nAdding line - Fe II 1083 [1083.420460 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1083 [1083.420460 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 23298.03it/s]\nAdding line - Fe II 1082 [1081.875260 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1082 [1081.875260 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 17173.83it/s]\nAdding line - Fe II 1064 [1063.971790 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1064 [1063.971790 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 23446.69it/s]\nAdding line - Fe II 1063 [1063.176870 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1063 [1063.176870 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 7334.15it/s]\nAdding line - Fe II 1062 [1062.153100 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1062 [1062.153100 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 26158.87it/s]\nAdding line - Fe II 1055 [1055.261760 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 1055 [1055.261760 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 20271.58it/s]\nAdding line - Fe II 938 [937.651330 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 938 [937.651330 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 26219.04it/s]\nAdding line - Fe II 927 [926.896870 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 927 [926.896870 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 29119.48it/s]\nAdding line - Fe II 926 [926.212010 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 926 [926.212010 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 10985.28it/s]\nAdding line - Fe II 924 [923.878210 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Fe II 924 [923.878210 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 30283.78it/s]\nyt : [INFO     ] 2023-09-11 17:01:34,084 Not adding continuum Ly C: insufficient column density or out of range\nyt : [INFO     ] 2023-09-11 17:01:34,090 Applying specified line spread function.\nyt : [INFO     ] 2023-09-11 17:01:34,095 Writing spectrum to hdf5 file: LightRays/spec_all_ray1.h5.\nyt : [INFO     ] 2023-09-11 17:01:34,097 Setting instrument to Custom\nyt : [INFO     ] 2023-09-11 17:01:34,134 Allocating for 121 particles\nyt : [INFO     ] 2023-09-11 17:01:34,204 Using all 213 available lines in 'lines.txt'.\nyt : [INFO     ] 2023-09-11 17:01:34,206 Creating C_p0_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,209 Creating C_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,210 Creating C_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,211 Creating C_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,212 Creating N_p0_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,214 Creating N_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,215 Creating N_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,217 Creating N_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,218 Creating N_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,219 Creating O_p0_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,220 Creating O_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,222 Creating O_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,223 Creating O_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,224 Creating O_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,226 Creating Ne_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,228 Creating Ne_p5_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,229 Creating Ne_p6_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,230 Creating Ne_p7_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,231 Creating Na_p8_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,232 Creating Mg_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,233 Creating Mg_p9_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,235 Creating Al_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,236 Creating Al_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,237 Creating Si_p11_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,238 Creating P_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,240 Creating P_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,241 Creating S_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,242 Creating S_p2_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,244 Creating S_p3_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,245 Creating S_p4_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,246 Creating S_p5_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,247 Creating S_p13_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,249 Creating Ar_p0_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,250 Creating Ar_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,252 Creating Ar_p6_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,253 Creating Ca_p9_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,255 Creating Fe_p1_number_density from ray's fields.\nyt : [INFO     ] 2023-09-11 17:01:34,257 Creating spectrum\nAdding line - Ly a [1215.670000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly a [1215.670000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 1461.21it/s]\nAdding line - Ly b [1025.722200 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly b [1025.722200 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6505.49it/s]\nAdding line - Ly c [972.536740 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly c [972.536740 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7559.57it/s]\nAdding line - Ly d [949.742980 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly d [949.742980 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7620.47it/s]\nAdding line - Ly e [937.803400 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly e [937.803400 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7943.88it/s]\nAdding line - Ly 6 [930.748200 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 6 [930.748200 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8158.93it/s]\nAdding line - Ly 7 [926.225640 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 7 [926.225640 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8156.03it/s]\nAdding line - Ly 8 [923.150300 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 8 [923.150300 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8219.83it/s]\nAdding line - Ly 9 [920.963026 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 9 [920.963026 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8122.33it/s]\nAdding line - Ly 10 [919.351351 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 10 [919.351351 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8164.89it/s]\nAdding line - Ly 11 [918.129312 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 11 [918.129312 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8018.17it/s]\nAdding line - Ly 12 [917.180525 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 12 [917.180525 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8221.98it/s]\nAdding line - Ly 13 [916.429085 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 13 [916.429085 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8228.83it/s]\nAdding line - Ly 14 [915.823759 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 14 [915.823759 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8345.49it/s]\nAdding line - Ly 15 [915.328939 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 15 [915.328939 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8458.96it/s]\nAdding line - Ly 16 [914.919249 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 16 [914.919249 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8518.52it/s]\nAdding line - Ly 17 [914.576207 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 17 [914.576207 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8217.95it/s]\nAdding line - Ly 18 [914.286092 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 18 [914.286092 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7803.36it/s]\nAdding line - Ly 19 [914.038542 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 19 [914.038542 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8589.90it/s]\nAdding line - Ly 20 [913.825614 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 20 [913.825614 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8083.59it/s]\nAdding line - Ly 21 [913.641137 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 21 [913.641137 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7849.23it/s]\nAdding line - Ly 22 [913.480256 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 22 [913.480256 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6771.29it/s]\nAdding line - Ly 23 [913.339110 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 23 [913.339110 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 5227.69it/s]\nAdding line - Ly 24 [913.214596 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 24 [913.214596 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7352.09it/s]\nAdding line - Ly 25 [913.104199 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 25 [913.104199 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 4856.16it/s]\nAdding line - Ly 26 [913.005863 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 26 [913.005863 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6525.98it/s]\nAdding line - Ly 27 [912.917891 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 27 [912.917891 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 4515.67it/s]\nAdding line - Ly 28 [912.838877 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 28 [912.838877 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6579.39it/s]\nAdding line - Ly 29 [912.767643 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 29 [912.767643 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6529.88it/s]\nAdding line - Ly 30 [912.703200 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 30 [912.703200 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6614.93it/s]\nAdding line - Ly 31 [912.644712 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 31 [912.644712 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7583.49it/s]\nAdding line - Ly 32 [912.591467 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 32 [912.591467 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6294.60it/s]\nAdding line - Ly 33 [912.542856 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 33 [912.542856 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6151.89it/s]\nAdding line - Ly 34 [912.498356 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 34 [912.498356 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7724.44it/s]\nAdding line - Ly 35 [912.457516 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 35 [912.457516 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7876.13it/s]\nAdding line - Ly 36 [912.419946 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 36 [912.419946 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6100.29it/s]\nAdding line - Ly 37 [912.385306 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 37 [912.385306 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7004.13it/s]\nAdding line - Ly 38 [912.353298 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 38 [912.353298 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 5358.82it/s]\nAdding line - Ly 39 [912.323663 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly 39 [912.323663 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6850.55it/s]\nAdding line - C I 1657 [1656.929000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1657 [1656.929000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 11602.23it/s]\nAdding line - C I 1560 [1560.309000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1560 [1560.309000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7867.89it/s]\nAdding line - C I 1329 [1328.834000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1329 [1328.834000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10622.30it/s]\nAdding line - C I 1280 [1280.135000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1280 [1280.135000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10507.87it/s]\nAdding line - C I 1277 [1277.245000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1277 [1277.245000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8490.78it/s]\nAdding line - C I 1261 [1260.735000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1261 [1260.735000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 9042.21it/s]\nAdding line - C I 1194 [1193.995000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1194 [1193.995000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12869.91it/s]\nAdding line - C I 1193 [1193.031000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1193 [1193.031000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12866.29it/s]\nAdding line - C I 1189 [1188.833000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1189 [1188.833000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 11953.27it/s]\nAdding line - C I 1158 [1157.910000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C I 1158 [1157.910000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8339.13it/s]\nAdding line - C II* 1336 [1335.663000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C II* 1336 [1335.663000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10668.68it/s]\nAdding line - C II 1335 [1334.532000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C II 1335 [1334.532000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 4096.80it/s]\nAdding line - C II* 1037 [1037.018000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C II* 1037 [1037.018000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 3694.93it/s]\nAdding line - C II 1036 [1036.337000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C II 1036 [1036.337000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6298.15it/s]\nyt : [INFO     ] 2023-09-11 17:01:35,387 30 out of 121 line components are unresolved.\nAdding line - C II 904 [903.962000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C II 904 [903.962000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 2266.43it/s]\nyt : [INFO     ] 2023-09-11 17:01:35,448 26 out of 121 line components are unresolved.\nAdding line - C III 977 [977.020000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C III 977 [977.020000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 2604.11it/s]\nAdding line - C IV 1551 [1550.772000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C IV 1551 [1550.772000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7139.44it/s]\nAdding line - C IV 1548 [1548.187000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - C IV 1548 [1548.187000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7094.26it/s]\nAdding line - N I 1201 [1200.710000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 1201 [1200.710000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8233.81it/s]\nAdding line - N I 1200 [1200.223000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 1200 [1200.223000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8257.05it/s]\nAdding line - N I 1200 [1199.550000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 1200 [1199.550000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 11965.21it/s]\nAdding line - N I 1135 [1134.980000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 1135 [1134.980000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14610.91it/s]\nAdding line - N I 1134 [1134.415000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 1134 [1134.415000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14414.65it/s]\nAdding line - N I 1134 [1134.165000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 1134 [1134.165000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 17233.91it/s]\nyt : [INFO     ] 2023-09-11 17:01:35,625 30 out of 121 line components are unresolved.\nAdding line - N I 965 [965.041000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 965 [965.041000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13175.13it/s]\nAdding line - N I 965 [964.626000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 965 [964.626000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13044.69it/s]\nAdding line - N I 964 [963.990000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 964 [963.990000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10974.83it/s]\nAdding line - N I 954 [954.104000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 954 [954.104000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12212.57it/s]\nAdding line - N I 954 [953.970000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 954 [953.970000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 11947.60it/s]\nAdding line - N I 954 [953.655000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 954 [953.655000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7462.18it/s]\nAdding line - N I 953 [953.415000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 953 [953.415000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 9207.46it/s]\nAdding line - N I 952 [952.415000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 952 [952.415000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 21333.30it/s]\nAdding line - N I 952 [952.303000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N I 952 [952.303000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14543.36it/s]\nyt : [INFO     ] 2023-09-11 17:01:35,757 18 out of 121 line components are unresolved.\nAdding line - N II 1084 [1083.990000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N II 1084 [1083.990000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 5436.21it/s]\nyt : [INFO     ] 2023-09-11 17:01:35,783 30 out of 121 line components are unresolved.\nAdding line - N II 916 [915.612000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N II 916 [915.612000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 4595.41it/s]\nyt : [INFO     ] 2023-09-11 17:01:35,818 29 out of 121 line components are unresolved.\nAdding line - N III 990 [989.799000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N III 990 [989.799000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 9233.64it/s]\nyt : [INFO     ] 2023-09-11 17:01:35,841 32 out of 121 line components are unresolved.\nAdding line - N IV 765 [765.147000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N IV 765 [765.147000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7605.50it/s]\nAdding line - N V 1243 [1242.804000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N V 1243 [1242.804000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15414.10it/s]\nAdding line - N V 1239 [1238.821000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - N V 1239 [1238.821000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13256.68it/s]\nAdding line - O I* 1306 [1306.029000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I* 1306 [1306.029000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7782.96it/s]\nAdding line - O I* 1305 [1304.858000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I* 1305 [1304.858000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 11499.65it/s]\nAdding line - O I 1302 [1302.168000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 1302 [1302.168000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 9417.64it/s]\nyt : [INFO     ] 2023-09-11 17:01:35,940 30 out of 121 line components are unresolved.\nAdding line - O I 1039 [1039.230000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 1039 [1039.230000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14659.42it/s]\nAdding line - O I 989 [988.773000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 989 [988.773000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10417.61it/s]\nAdding line - O I 989 [988.655000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 989 [988.655000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15609.13it/s]\nAdding line - O I 976 [976.448000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 976 [976.448000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 17904.61it/s]\nAdding line - O I 951 [950.885000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 951 [950.885000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 16253.84it/s]\nAdding line - O I 937 [936.629000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 937 [936.629000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 17636.71it/s]\nAdding line - O I 930 [929.517000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 930 [929.517000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15582.55it/s]\nAdding line - O I 925 [924.950000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 925 [924.950000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 18165.02it/s]\nAdding line - O I 922 [922.008000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O I 922 [922.008000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13627.09it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,030 31 out of 121 line components are unresolved.\nAdding line - O II 834 [834.465400 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O II 834 [834.465400 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 4969.70it/s]\nAdding line - O II 833 [833.330300 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O II 833 [833.330300 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 5539.84it/s]\nAdding line - O II 833 [832.758300 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O II 833 [832.758300 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6798.17it/s]\nAdding line - O III* 835 [835.289000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O III* 835 [835.289000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14499.78it/s]\nAdding line - O III* 835 [835.289000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O III* 835 [835.289000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14466.86it/s]\nAdding line - O III 833 [832.929000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O III 833 [832.929000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14223.20it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,131 32 out of 121 line components are unresolved.\nAdding line - O III* 703 [702.838000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O III* 703 [702.838000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15522.48it/s]\nAdding line - O III 702 [702.337000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O III 702 [702.337000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15286.29it/s]\nAdding line - O IV* 790 [790.199000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O IV* 790 [790.199000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13591.03it/s]\nAdding line - O IV 788 [787.710000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O IV 788 [787.710000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13714.72it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,174 34 out of 121 line components are unresolved.\nAdding line - O IV* 610 [609.829000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O IV* 610 [609.829000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13974.41it/s]\nAdding line - O IV 608 [608.397000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O IV 608 [608.397000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12778.10it/s]\nAdding line - O IV* 555 [554.513000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O IV* 555 [554.513000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12554.04it/s]\nAdding line - O IV 554 [554.076000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O IV 554 [554.076000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13564.29it/s]\nAdding line - O IV 553 [553.329000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O IV 553 [553.329000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13797.81it/s]\nAdding line - O V 630 [629.732000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O V 630 [629.732000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 17421.82it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,240 30 out of 121 line components are unresolved.\nAdding line - O VI 1038 [1037.613000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O VI 1038 [1037.613000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 18220.26it/s]\nAdding line - O VI 1032 [1031.912000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - O VI 1032 [1031.912000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14836.59it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,261 34 out of 121 line components are unresolved.\nAdding line - Ne V* 572 [572.335000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ne V* 572 [572.335000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 18031.62it/s]\nAdding line - Ne V* 570 [569.828000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ne V* 570 [569.828000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 17226.25it/s]\nAdding line - Ne V 568 [568.424000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ne V 568 [568.424000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 17678.84it/s]\nAdding line - Ne VI* 563 [562.805000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ne VI* 563 [562.805000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15833.54it/s]\nAdding line - Ne VI 559 [558.603000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ne VI 559 [558.603000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 17011.41it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,310 35 out of 121 line components are unresolved.\nAdding line - Ne VII 465 [465.221000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ne VII 465 [465.221000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 20751.04it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,320 32 out of 121 line components are unresolved.\nAdding line - Ne VIII 780 [780.324000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ne VIII 780 [780.324000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 19727.07it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,327 34 out of 121 line components are unresolved.\nAdding line - Ne VIII 770 [770.409000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ne VIII 770 [770.409000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14964.51it/s]\nAdding line - Na IX 694 [694.150000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Na IX 694 [694.150000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 20090.87it/s]\nAdding line - Na IX 682 [681.720000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Na IX 682 [681.720000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 21435.05it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,358 30 out of 121 line components are unresolved.\nAdding line - Mg II 1240 [1240.394700 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Mg II 1240 [1240.394700 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 11641.68it/s]\nAdding line - Mg II 1240 [1239.925300 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Mg II 1240 [1239.925300 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 11989.43it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,383 34 out of 121 line components are unresolved.\nAdding line - Mg X 625 [624.941000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Mg X 625 [624.941000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 21528.57it/s]\nAdding line - Mg X 610 [609.793000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Mg X 610 [609.793000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 21432.31it/s]\nAdding line - Al II 1671 [1670.787400 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Al II 1671 [1670.787400 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7599.29it/s]\nAdding line - Al III 1863 [1862.789500 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Al III 1863 [1862.789500 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14568.19it/s]\nAdding line - Al III 1855 [1854.716400 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Al III 1855 [1854.716400 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 13690.84it/s]\nAdding line - Si II* 1817 [1816.928000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II* 1817 [1816.928000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 16249.64it/s]\nAdding line - Si II 1808 [1808.013000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II 1808 [1808.013000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15327.72it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,460 30 out of 121 line components are unresolved.\nAdding line - Si II* 1309 [1309.276000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II* 1309 [1309.276000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6789.28it/s]\nAdding line - Si II 1304 [1304.370000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II 1304 [1304.370000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 2325.22it/s]\nAdding line - Si II* 1265 [1264.738000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II* 1265 [1264.738000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 3910.56it/s]\nAdding line - Si II 1260 [1260.422000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II 1260 [1260.422000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 1390.63it/s]\nAdding line - Si II* 1197 [1197.394000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II* 1197 [1197.394000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 3844.78it/s]\nAdding line - Si II* 1194 [1194.500000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II* 1194 [1194.500000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 1686.06it/s]\nAdding line - Si II 1193 [1193.290000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II 1193 [1193.290000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 2046.27it/s]\nAdding line - Si II 1190 [1190.416000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II 1190 [1190.416000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 3953.50it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,850 32 out of 121 line components are unresolved.\nAdding line - Si II* 1024 [1023.700000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II* 1024 [1023.700000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 19087.43it/s]\nAdding line - Si II 1021 [1020.699000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II 1021 [1020.699000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 20198.91it/s]\nAdding line - Si II* 993 [992.683000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II* 993 [992.683000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8134.41it/s]\nAdding line - Si II 990 [989.873000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si II 990 [989.873000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7239.88it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,901 30 out of 121 line components are unresolved.\nAdding line - Si III 1206 [1206.500000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si III 1206 [1206.500000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 4242.96it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,932 29 out of 121 line components are unresolved.\nAdding line - Si IV 1403 [1402.770000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si IV 1403 [1402.770000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12794.66it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,945 35 out of 121 line components are unresolved.\nAdding line - Si XII 521 [520.665000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si XII 521 [520.665000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 27191.60it/s]\nAdding line - Si XII 499 [499.406000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si XII 499 [499.406000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 26688.40it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,960 34 out of 121 line components are unresolved.\nAdding line - P IV 951 [950.657000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - P IV 951 [950.657000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 22557.10it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,970 32 out of 121 line components are unresolved.\nAdding line - P V 1128 [1128.008000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - P V 1128 [1128.008000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15343.14it/s]\nAdding line - P V 1118 [1117.977000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - P V 1118 [1117.977000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15671.83it/s]\nyt : [INFO     ] 2023-09-11 17:01:36,991 31 out of 121 line components are unresolved.\nAdding line - S II 1260 [1259.519000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S II 1260 [1259.519000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12268.83it/s]\nAdding line - S II 1254 [1253.811000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S II 1254 [1253.811000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12236.62it/s]\nAdding line - S II 1251 [1250.584000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S II 1251 [1250.584000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12274.81it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,024 34 out of 121 line components are unresolved.\nAdding line - S II 913 [912.736000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S II 913 [912.736000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14079.18it/s]\nAdding line - S II 910 [910.485000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S II 910 [910.485000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 11651.65it/s]\nAdding line - S II 907 [906.876000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S II 907 [906.876000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10628.13it/s]\nAdding line - S II 766 [765.684000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S II 766 [765.684000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 4465.07it/s]\nAdding line - S II 764 [764.416000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S II 764 [764.416000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 4991.29it/s]\nAdding line - S II 764 [763.656000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S II 764 [763.656000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 5835.15it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,137 31 out of 121 line components are unresolved.\nAdding line - S III* 1201 [1200.966000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 1201 [1200.966000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10802.17it/s]\nAdding line - S III* 1194 [1194.058000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 1194 [1194.058000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10605.29it/s]\nAdding line - S III 1190 [1190.203000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III 1190 [1190.203000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10560.56it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,174 32 out of 121 line components are unresolved.\nAdding line - S III* 1021 [1021.323000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 1021 [1021.323000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 18667.62it/s]\nAdding line - S III* 1021 [1021.108000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 1021 [1021.108000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 18374.58it/s]\nAdding line - S III* 1016 [1015.779000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 1016 [1015.779000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 18999.53it/s]\nAdding line - S III* 1016 [1015.567000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 1016 [1015.567000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 19101.92it/s]\nAdding line - S III* 1016 [1015.502000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 1016 [1015.502000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 19373.97it/s]\nAdding line - S III 1012 [1012.495000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III 1012 [1012.495000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 17905.25it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,221 34 out of 121 line components are unresolved.\nAdding line - S III* 729 [728.685000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 729 [728.685000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7535.35it/s]\nAdding line - S III* 726 [725.858000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 726 [725.858000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 9410.25it/s]\nAdding line - S III 724 [724.288000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III 724 [724.288000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10848.27it/s]\nAdding line - S III* 703 [702.779000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 703 [702.779000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7606.53it/s]\nAdding line - S III* 700 [700.288000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 700 [700.288000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8676.08it/s]\nAdding line - S III* 700 [700.150000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 700 [700.150000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 9956.80it/s]\nAdding line - S III 699 [698.727000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III 699 [698.727000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 8226.95it/s]\nAdding line - S III* 681 [680.925000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 681 [680.925000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10982.97it/s]\nAdding line - S III* 681 [680.677000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 681 [680.677000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 5687.19it/s]\nAdding line - S III* 678 [678.456000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III* 678 [678.456000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 7181.82it/s]\nAdding line - S III 678 [677.729000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S III 678 [677.729000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 6734.77it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,401 32 out of 121 line components are unresolved.\nAdding line - S IV* 1073 [1072.973000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S IV* 1073 [1072.973000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 23315.72it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,408 34 out of 121 line components are unresolved.\nAdding line - S IV* 816 [815.941000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S IV* 816 [815.941000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 21443.27it/s]\nAdding line - S IV 810 [809.656000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S IV 810 [809.656000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 22509.68it/s]\nAdding line - S IV* 754 [753.760000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S IV* 754 [753.760000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 23469.01it/s]\nAdding line - S IV* 750 [750.221000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S IV* 750 [750.221000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 22518.75it/s]\nAdding line - S IV 748 [748.393000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S IV 748 [748.393000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 21961.62it/s]\nAdding line - S IV 745 [744.904000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S IV 745 [744.904000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 22753.91it/s]\nAdding line - S IV 657 [657.319000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S IV 657 [657.319000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 19020.35it/s]\nAdding line - S V 786 [786.468000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S V 786 [786.468000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 14974.31it/s]\nAdding line - S VI 945 [944.523000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S VI 945 [944.523000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15619.30it/s]\nAdding line - S VI 933 [933.378000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S VI 933 [933.378000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 15213.29it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,494 36 out of 121 line components are unresolved.\nAdding line - S XIV 446 [445.700000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S XIV 446 [445.700000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 27193.07it/s]\nAdding line - S XIV 418 [417.660000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - S XIV 418 [417.660000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 27954.26it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,509 34 out of 121 line components are unresolved.\nAdding line - Ar I 1067 [1066.660000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ar I 1067 [1066.660000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 33047.70it/s]\nAdding line - Ar I 1048 [1048.220000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ar I 1048 [1048.220000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 29925.47it/s]\nAdding line - Ar II* 726 [725.548530 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ar II* 726 [725.548530 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 23857.25it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,529 35 out of 121 line components are unresolved.\nAdding line - Ar II 723 [723.360560 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ar II 723 [723.360560 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 24488.71it/s]\nAdding line - Ar II 718 [718.089852 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ar II 718 [718.089852 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 33677.92it/s]\nAdding line - Ar VII 586 [585.748000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ar VII 586 [585.748000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 17998.73it/s]\nAdding line - Ca X 574 [574.010000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ca X 574 [574.010000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 21085.73it/s]\nAdding line - Ca X 558 [557.765000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ca X 558 [557.765000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 20253.37it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,572 31 out of 121 line components are unresolved.\nAdding line - Fe II 1608 [1608.450830 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1608 [1608.450830 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 10092.57it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,585 34 out of 121 line components are unresolved.\nAdding line - Fe II 1143 [1143.225730 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1143 [1143.225730 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 21811.25it/s]\nAdding line - Fe II 1127 [1127.098400 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1127 [1127.098400 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 29680.18it/s]\nAdding line - Fe II 1125 [1125.447630 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1125 [1125.447630 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 22992.99it/s]\nAdding line - Fe II 1122 [1121.974710 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1122 [1121.974710 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 16669.42it/s]\nAdding line - Fe II 1112 [1112.048320 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1112 [1112.048320 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 25868.14it/s]\nAdding line - Fe II 1097 [1096.876870 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1097 [1096.876870 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 16000.14it/s]\nAdding line - Fe II 1083 [1083.420460 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1083 [1083.420460 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 26807.80it/s]\nAdding line - Fe II 1082 [1081.875260 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1082 [1081.875260 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 24139.88it/s]\nAdding line - Fe II 1064 [1063.971790 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1064 [1063.971790 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 24488.71it/s]\nAdding line - Fe II 1063 [1063.176870 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1063 [1063.176870 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 12675.76it/s]\nAdding line - Fe II 1062 [1062.153100 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1062 [1062.153100 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 26713.89it/s]\nAdding line - Fe II 1055 [1055.261760 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 1055 [1055.261760 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 28395.85it/s]\nAdding line - Fe II 938 [937.651330 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 938 [937.651330 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 30992.39it/s]\nAdding line - Fe II 927 [926.896870 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 927 [926.896870 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 31687.01it/s]\nAdding line - Fe II 926 [926.212010 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 926 [926.212010 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 19114.98it/s]\nAdding line - Fe II 924 [923.878210 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Fe II 924 [923.878210 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 28679.00it/s]\nyt : [INFO     ] 2023-09-11 17:01:37,695 Not adding continuum Ly C: insufficient column density or out of range\nyt : [INFO     ] 2023-09-11 17:01:37,701 Applying specified line spread function.\nyt : [INFO     ] 2023-09-11 17:01:37,703 Writing spectrum to hdf5 file: LightRays/spec_all_ray2.h5.\n\n\n\nfrom IPython.display import display, Image\n\n\n# Load the saved spectra and plot them together\nsg1 = trident.load_spectrum('LightRays/spec_all_ray1.h5')\nsg2 = trident.load_spectrum('LightRays/spec_all_ray2.h5')\n\nfilename = 'LightRays/COS130_1150_1300_allLines.png'\nplot_spectrum_Chad([sg1.lambda_field,sg2.lambda_field],\n        [sg1.flux_field,sg2.flux_field],\n        flux_limits = [0,1.5],\n        stagger=0.0, step=[True, True],\n        label=['Ray 1', 'Ray 2'], filename=filename)\n\nfig = Image(filename=filename)\ndisplay(fig)\n\nyt : [INFO     ] 2023-09-11 17:01:37,714 Setting instrument to Custom\n/var/folders/9t/skzkm_4169g47x95n5b3b5_h0000gn/T/ipykernel_88544/2514315971.py:250: MatplotlibDeprecationWarning: The label function was deprecated in Matplotlib 3.1 and will be removed in 3.8. Use Tick.label1 instead.\n  tick.label.set_fontsize(14)\n/var/folders/9t/skzkm_4169g47x95n5b3b5_h0000gn/T/ipykernel_88544/2514315971.py:252: MatplotlibDeprecationWarning: The label function was deprecated in Matplotlib 3.1 and will be removed in 3.8. Use Tick.label1 instead.\n  tick.label.set_fontsize(14)\nyt : [INFO     ] 2023-09-11 17:01:37,765 Writing spectrum plot to png file: LightRays/COS130_1150_1300_allLines.png\n\n\n\n\n\nWe see a lot of overlapping absorption lines between Ray 1 and Ray 2, except for around 1210-1220 A. Let’s zoom in on this region and label a few lines that I know are interesting: Si III 1206.5 and Lyman alpha.\n\nlambda_min,lambda_max = 1200, 1230\nsg1 = trident.SpectrumGenerator(lambda_min=lambda_min, lambda_max=lambda_max, dlambda=0.01)\nsg1.make_spectrum(ray1, lines={'Si III 1206','Ly a'}, use_peculiar_velocity=True,\n                  store_observables=True)\nsg1.add_milky_way_foreground()\nsg1.apply_lsf(filename='avg_COS.txt')\nsg1.add_gaussian_noise(30)\nsg1.save_spectrum('LightRays/spec_SiIII_Lya_ray1.h5')\n\nsg2 = trident.SpectrumGenerator(lambda_min=lambda_min, lambda_max=lambda_max, dlambda=0.01)\nsg2.make_spectrum(ray2, lines={'Si III 1206', 'Ly a'}, use_peculiar_velocity=True,\n                 store_observables=True)\nsg2.add_milky_way_foreground()\nsg2.apply_lsf(filename='avg_COS.txt')\nsg2.add_gaussian_noise(30)\nsg2.save_spectrum('LightRays/spec_SiIII_Lya_ray2.h5')\n\nplot_spectrum_Chad([sg1.lambda_field,sg2.lambda_field],\n        [sg1.flux_field,sg2.flux_field],\n        flux_limits = [0,1.5],\n        features={'Si III' : 1206.5, 'Ly a' : 1215.67},\n        stagger=0.0, step=[True, True],\n        label=['Ray 1', 'Ray 2'], filename='LightRays/COS130_1200_1230_SiIII_Lya.png')\n\ndisplay(Image(\"LightRays/COS130_1200_1230_SiIII_Lya.png\", embed=True))\n\nyt : [INFO     ] 2023-09-11 17:01:37,922 Setting instrument to Custom\nyt : [INFO     ] 2023-09-11 17:01:37,927 Creating spectrum\nAdding line - Ly a [1215.670000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Ly a [1215.670000 A]:  12%|█▏        | 13/107 [00:00&lt;00:00, 123.71it/s]Adding line - Ly a [1215.670000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 553.52it/s]\nyt : [INFO     ] 2023-09-11 17:01:38,134 33 out of 107 line components are unresolved.\nAdding line - Si III 1206 [1206.500000 A]:   0%|          | 0/107 [00:00&lt;?, ?it/s]Adding line - Si III 1206 [1206.500000 A]:  99%|█████████▉| 106/107 [00:00&lt;00:00, 3704.88it/s]\nyt : [INFO     ] 2023-09-11 17:01:38,165 Not adding continuum Ly C: insufficient column density or out of range\nyt : [INFO     ] 2023-09-11 17:01:38,167 Applying specified line spread function.\nyt : [INFO     ] 2023-09-11 17:01:38,168 Writing spectrum to hdf5 file: LightRays/spec_SiIII_Lya_ray1.h5.\nyt : [INFO     ] 2023-09-11 17:01:38,170 Setting instrument to Custom\nyt : [INFO     ] 2023-09-11 17:01:38,173 Creating spectrum\nAdding line - Ly a [1215.670000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Ly a [1215.670000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 1335.29it/s]\nyt : [INFO     ] 2023-09-11 17:01:38,271 30 out of 121 line components are unresolved.\nAdding line - Si III 1206 [1206.500000 A]:   0%|          | 0/121 [00:00&lt;?, ?it/s]Adding line - Si III 1206 [1206.500000 A]:  99%|█████████▉| 120/121 [00:00&lt;00:00, 4049.92it/s]\nyt : [INFO     ] 2023-09-11 17:01:38,303 Not adding continuum Ly C: insufficient column density or out of range\nyt : [INFO     ] 2023-09-11 17:01:38,305 Applying specified line spread function.\nyt : [INFO     ] 2023-09-11 17:01:38,306 Writing spectrum to hdf5 file: LightRays/spec_SiIII_Lya_ray2.h5.\n/var/folders/9t/skzkm_4169g47x95n5b3b5_h0000gn/T/ipykernel_88544/2514315971.py:250: MatplotlibDeprecationWarning: The label function was deprecated in Matplotlib 3.1 and will be removed in 3.8. Use Tick.label1 instead.\n  tick.label.set_fontsize(14)\n/var/folders/9t/skzkm_4169g47x95n5b3b5_h0000gn/T/ipykernel_88544/2514315971.py:252: MatplotlibDeprecationWarning: The label function was deprecated in Matplotlib 3.1 and will be removed in 3.8. Use Tick.label1 instead.\n  tick.label.set_fontsize(14)\nyt : [INFO     ] 2023-09-11 17:01:38,322 Writing spectrum plot to png file: LightRays/COS130_1200_1230_SiIII_Lya.png\n\n\n\n\n\nThe width of absorption lines, like the Lyman Alpha line shown above, are partially due to turbulent velocity dispersion, i.e. the random motions of fluid elements that redshift and blueshift the light we see on Earth.\n\n# Calculate the velocity standard deviation weighted by density\n\n # Profile plots\nraydat = ray1.all_data()\nlosvel = (raydat['velocity_los']/100000)*raydat['density'] \nprint(\"Value along ray 1: \")\nprint(np.std(losvel))\n\nraydat = ray2.all_data()\nlosvel = (raydat['velocity_los']/100000)*raydat['density'] \nprint(\"Value along ray 2: \")\nprint(np.std(losvel))\n\nValue along ray 1: \n2.3913198647901003e-24 g/(cm**2*s)\nValue along ray 2: \n6.301139948527954e-25 g/(cm**2*s)\n\n\nTurbulent motions are indeed stronger along ray 1 than ray 2, likely accounting for the increased line broadening. In fact, this interpretation makes physical sense given that ray 1 is closer to the LMC center where more star formation and wind driving occur, generating larger velocity and kinetic energy fluctuations."
  },
  {
    "objectID": "posts/post-with-code/index.html#other-useful-mock-observables-gamma-ray-emission-faraday-rotation-measure-and-h-alpha-emission",
    "href": "posts/post-with-code/index.html#other-useful-mock-observables-gamma-ray-emission-faraday-rotation-measure-and-h-alpha-emission",
    "title": "LMC Analysis: Part I",
    "section": "Other useful mock observables: gamma-ray emission, Faraday rotation measure, and H-alpha emission",
    "text": "Other useful mock observables: gamma-ray emission, Faraday rotation measure, and H-alpha emission\n\nSome outcomes of this analysis can be found in Bustard et al. 2020 ApJ (and various AAS poster presentations by UW undergraduates), Ciampa et al. 2021 ApJ, and Livingston et al. 2023, in prep.\n\n\nFaraday rotation measure\nThe line-of-sight (LOS) magnetic field strength is commonly probed by Faraday rotation measure, an integral along the LOS with dependence on the LOS magnetic field strength, B\\(_{\\rm LOS}\\) and the electron number density, \\(n_{e}\\).\nBecause \\(n_{e}\\) depends on the ionization state of the gas, this is more complex to calculate and can’t be simply pulled out from yt. Here, we’ve loaded in tables of \\(n_{e}/n_{H}\\) as a function of the hydrogen number density \\(n_{H}\\) and the gas temperature. We then use a bilinear interpolator to interpolate between values in this 2D space.\n\nfrom numpy import *\nimport h5py\nimport matplotlib.cm as cm\nimport matplotlib.mlab as mlab\nfrom yt.fields import interpolated_fields\nfrom yt.fields.field_detector import \\\n    FieldDetector\nfrom yt.utilities.linear_interpolators import \\\n    BilinearFieldInterpolator\n\nds = yt.load(\"windCRs_hdf5_plt_cnt_0050\")\n\n# pre-tabulated text files for ne/nH, T, nH\nnenh = loadtxt('nenh.txt')\ntempTxt = loadtxt('Temps.txt')\nnHTxt = loadtxt('NH.txt')\n\n# ne/nH\ndef _nenh_interp(field, data):\n    # use yt's bilinear interpolator:\n    interp = BilinearFieldInterpolator(nenh,boundaries=[tempTxt,nHTxt],field_names=['temperature','number_density'], truncate=True)\n \n    field_data = interp(data)\n    field_data[field_data &lt; 0] = 0.01 # if extrapolating, set a floor value of 1/100 -- this is a bit arbitrary and could be improved in the future\n    return(field_data)\n \nds.add_field(('gas','nenh_interp'), function=_nenh_interp, units=\"\", take_log=False, display_name=r'$n_{e} / n_{H}$', sampling_type=\"cell\")\n\ndef _log10_nenh_interp(field, data): # create the log10 version too just for ease\n    return(np.log10(data['nenh_interp']))\n\nds.add_field(('gas','log10_nenh_interp'), function=_log10_nenh_interp, units=\"\", take_log=False, display_name=r'log10($n_{e} / n_{H}$)', sampling_type=\"cell\")\n\n\n# Rotation measure\ndef _rotationMeasure(field, data):\n    # use yt's bilinear interpolator:\n    interp = BilinearFieldInterpolator(nenh,boundaries=[tempTxt,nHTxt], \n                                    field_names=['temperature','number_density'], truncate=True)\n    field_data = interp(data)\n    field_data[field_data &lt; 0] = 0.01\n    return 0.812*field_data*data['number_density']*((-0.561*data['magnetic_field_x'] \n                        + 0.099*data['magnetic_field_y']\n                        + 0.822*data['magnetic_field_z'])/1.e-6)*(1./3.0856e18)\n \nds.add_field(('gas','rotationMeasure'), function=_rotationMeasure, units=\"gauss/cm**3\", take_log=False, display_name='Rotation Measure', sampling_type=\"cell\")\n\n# B_LOS\ndef _losBField(field,data):\n    return (-0.561*data['magnetic_field_x'] + 0.099*data['magnetic_field_y'] + 0.822*data['magnetic_field_z'])/1.e-6\n \nds.add_field(('gas','losBField'), function=_losBField, units=\"gauss\", take_log=False, display_name='Line of Sight B Field', sampling_type=\"cell\")\n\nyt : [INFO     ] 2023-09-11 17:01:38,504 Parameters: current_time              = 3.156010944496386e+16\nyt : [INFO     ] 2023-09-11 17:01:38,504 Parameters: domain_dimensions         = [96 96 96]\nyt : [INFO     ] 2023-09-11 17:01:38,505 Parameters: domain_left_edge          = [-6.171e+22 -6.171e+22 -6.171e+22]\nyt : [INFO     ] 2023-09-11 17:01:38,506 Parameters: domain_right_edge         = [1.234e+23 1.234e+23 1.234e+23]\nyt : [INFO     ] 2023-09-11 17:01:38,506 Parameters: cosmological_simulation   = 0\n\n\n\n# Now plot the rotation measure as a mock observation\n\n# first create a FITS file with rotation measure we can call on later\nprj_fits = yt.FITSOffAxisProjection(ds,L,'rotationMeasure',center = (0,0,0), width=(10, 'kpc'))\nsky_center = [79.0,-68.68] # in degrees\nsky_scale = (4123.71, \"arcsec/kpc\") # could also use a YTQuantity\nprj_fits.create_sky_wcs(sky_center, sky_scale, ctype=[\"RA---TAN\",\"DEC--TAN\"],  replace_old_wcs=True)\nprj_fits.writeto(\"LMC_Ram_evolved_Faraday.fits\", overwrite=True)\nimage_data = fits.getdata('LMC_Ram_evolved_Faraday.fits')\n \n# open the FITS file and plot rotation measure\nfig = aplpy.FITSFigure(\"LMC_Ram_evolved_Faraday.fits\")\nfig.add_grid()\nfig.show_colorscale(cmap=\"RdBu\",stretch = 'linear',vmin=-100, vmax = 100)\nfig.tick_labels.set_xposition(\"top\")\nfig.ticks.set_xspacing(8.0)\nfig.ticks.set_yspacing(8.0)\nfig.add_colorbar()\nfig.tick_labels.set_xformat('hh:mm')\nfig.tick_labels.set_yformat('dd')\nfig.colorbar.set_axis_label_text(r'Rotation Measure $\\phi$ (rad $ m^{-2}$)')\n\nyt : [INFO     ] 2023-09-11 17:02:17,670 Making a FITS image of field rotationMeasure\n\n\n\n\n\nOn the surface, this map looks quite reasonable…|RM| is highest near the center of the galaxy where both the density and magnetic field strength are presumably the largest, and due to the tilt of the galaxy, the B field is primarily directed toward us in the lower half and away from us in the upper half of the image. However, these RM values are quite a bit higher than what is observed, suggesting that either the electron density or magnetic field strength are too high. Or it could be that neither is, on average, too large, but they are too large in the same locations.\nLet’s take a look at both \\(n_{e}/n_{H}\\) and \\(B_{los}\\)\n\n# Now plot ne/nH to get a sense of how ionized the gas is.\nregion = ds.box([0.0,-6.17E22,-3.0856E22],[1.2E23,6.17E22,3.0856E22])\nL = [-0.561,0.099,0.822] # vector normal to cutting plane\nd = yt.OffAxisProjectionPlot(ds, L, 'nenh_interp',weight_field=\"density\",center=[0.0,0.0,0.0], width=(10, 'kpc'),fontsize=20)\nd.set_cmap(field=\"nenh_interp\", cmap='PuOr')\nd.set_colorbar_label(\"nenh_interp\", \"$n_{e}/n_{H}$\")\nd.annotate_timestamp()\nd.show()\n\nd = yt.OffAxisProjectionPlot(ds, L, \"losBField\",weight_field=\"density\",center=[0.0,0.0,0.0], width=(10, 'kpc'),fontsize=20)\nd.set_cmap(field=\"losBField\", cmap='cmr.wildfire')\nd.set_colorbar_label(\"losBField\", r\"B$_{\\rm LOS}$\")\nd.annotate_timestamp()\nd.show()\n\nyt : [INFO     ] 2023-09-11 17:02:19,326 xlim = -15428387904811624824832.000000 15428387904811624824832.000000\nyt : [INFO     ] 2023-09-11 17:02:19,327 ylim = -15428387904811624824832.000000 15428387904811624824832.000000\nyt : [INFO     ] 2023-09-11 17:02:19,328 zlim = -92554999999999995019264.000000 92554999999999995019264.000000\nyt : [INFO     ] 2023-09-11 17:02:19,329 Making a fixed resolution buffer of (('gas', 'nenh_interp')) 800 by 800\nyt : [INFO     ] 2023-09-11 17:02:47,801 xlim = -15428387904811624824832.000000 15428387904811624824832.000000\nyt : [INFO     ] 2023-09-11 17:02:47,802 ylim = -15428387904811624824832.000000 15428387904811624824832.000000\nyt : [INFO     ] 2023-09-11 17:02:47,802 zlim = -92554999999999995019264.000000 92554999999999995019264.000000\nyt : [INFO     ] 2023-09-11 17:02:47,803 Making a fixed resolution buffer of (('gas', 'losBField')) 800 by 800\n\n\n\n\n\n\n\n\nLet’s also make a phase plot showing cell-by-cell how the gas density, temperature, and ionization given by \\(n_{e}/n_{H}\\) correlate.\n\ndd = ds.all_data()\nplot = yt.PhasePlot(dd, \"number_density\", \"temperature\", \"log10_nenh_interp\",fontsize = 28)\n# plot.set_cmap(field=\"magnetic_field_magnitude\", cmap='viridis')\nplot.set_cmap(field=\"log10_nenh_interp\", cmap='viridis')\nplot.set_ylim(1.E3,1.E7)\nplot.set_xlim(1.E-3,1.E1)\n# plot.set_zlim(field='magnetic_field_magnitude', zmin=1.E-8, zmax=1.E-5)\nplot.set_zlim(field='log10_nenh_interp', zmin=-2, zmax=0.1)\nplot.show()\n\n\n\n\n\n# Check a mass-weighted PDF of ne/nh -- how much of the gas (by mass) has hit the floor I've imposed on ne/nh?\nplot = yt.ProfilePlot(\n    dd,\n    (\"gas\", \"log10_nenh_interp\"),\n    [(\"gas\", \"rotationMeasure\")],accumulation=False\n)\nplot.set_log((\"gas\", \"log10_nenh_interp\"), False)\nplot.show()\n\n\n\n\nA huge fraction of the rotation measure comes from cells with floored ne/nh = 1e-2. Yikes!\nThe lesson: gas ionization is hard to model, and this implementation, which assumes photoionization equilibrium and neglects things like local ionizing radiation fields from massive stars in the LMC disk, is too naive. Nevertheless, the LMC simulations presented here provide useful comparisons to observations when a thorough analysis is done and their limitations are known\n\n\nH \\(\\alpha\\) emission – probing ~ 2e4 K gas\nThis shows a quick example of how to measure H-alpha emission from a series of simulation snapshots. For our example, we just use one snapshot, but this script can be applied to any other FLASH simulation output with a “cooling” output variable capturing the radiative cooling rate (See Bustard and Gronke 2022 for a use-case involving idealized simulations of the Magellanic Stream compared to real H-alpha observations)\nInput: Set of simulation snapshots Output: A rough image, a table with columns = (time, max emission, average emission, standard deviation of emission)\n\nimport matplotlib as plt\nfrom yt.units import Mpc\nimport collections\nimport glob\n\nyt.enable_parallelism()\n\npUnit = YTQuantity(1, 'cm**2/s**2')\n\n# New function that takes in cooling rate ('cloo') and converts it to H-alpha luminosity\ndef CoolingmR(field,data):\n    return data['cloo']*YTQuantity(1,'erg/cm**3/s')/(4.0*np.pi*2.41e-10) # in mR\n\nyt.add_field((\"gas\",\"CoolingmR\"), function=CoolingmR, sampling_type='local',units=\"erg/cm**3/s\")\n\n\nnum_procs = 1\n\n# Could load in more than one data file and create a table with H-alpha statistics,\n# but here we only use one data file (the one we downloaded)\nfns = glob.glob('windCRs_hdf5_plt_cnt_0050*')\nfns.sort()\n\n# Create an empty dictionary\ndata = {}\n\n# Iterate through each dataset in the Time Series (using piter allows it\n# to happen in parallel automatically across available processors)\nfor sto,fn in yt.parallel_objects(fns,num_procs,storage=data):\n    ds = yt.load(fn)\n    ad = ds.all_data()\n    # ds.periodicity = (True,True,True) # deprecated\n    ds.coordinates.x_axis[1] = 0\n    ds.coordinates.y_axis[1] = 2\n    \n    L = [-0.561,0.099,0.822] # vector normal to cutting plane\n    d = yt.OffAxisProjectionPlot(ds, L, 'CoolingmR',center=[0.0,0.0,0.0], width=(10, 'kpc'),fontsize=20)\n    d.set_cmap(field=\"CoolingmR\", cmap='PuOr')\n    d.set_colorbar_label(\"CoolingmR\", \"$mR$\")\n    d.annotate_timestamp()\n    d.show()\n    \n    dense_ad = ad.cut_region(['obj[\"CoolingmR\"] &gt; 0.0'])\n    # c = yt.ProjectionPlot(ds, 1, \"cloo\",weight_field=\"density\",fontsize=28)\n    proj = ds.proj(\"CoolingmR\",1,data_source=dense_ad)\n    \n    #degrade the resolution to [nx,ny] -- we can play with this to mock the effects of lower resolution instruments\n    frb = proj.to_frb(width=(100,'kpc'),resolution=[128,128]) \n    my_image = np.array(frb[\"CoolingmR\"])\n    \n    #filtered_image = np.array(filter(lambda num: num &gt; 0.0, my_image))\n    filtered_image = my_image[my_image &gt; 0.0]\n    \n    # get max, avg, and standard deviation of cells with &gt;0 emission\n    maxCol = np.amax(filtered_image)\n    avgCol = np.average(filtered_image)\n    stdCol = np.std(filtered_image)\n\n    # Fill the dictionary with extrema and redshift information for each dataset\n    time = ds.current_time.in_units('Myr')\n    sto.result_id = ds.basename\n    sto.result = (time, maxCol, avgCol, stdCol)\n   # data[ds.basename] = (time, extrema, var)\n# Convert dictionary to ordered dictionary to get the right order\n\nfilename = \"cool_file_res_128.txt\"\ncool_file = open(filename,\"w\")#write mode\n#if yt.is_root()\ncool_file.write(\"Dataset                          Time       Lum Max    Lum average    Lum std dev       \\n\")\ncool_file.write(\"---------------------------------------------------------------------------------------------------------------------------------------    \\n \")\nfor fn, val in sorted(data.items()):\n    cool_file.write(\"%s       %05.3f      %5.3g mR     %5.3g mR     %5.3g mR       \\n\" % \\\n           (fn, val[0], val[1], val[2], val[3]))    \n\ncool_file.close()\n\ncool_file = open(filename, \"r\")\nprint(cool_file.read())\n\nyt : [ERROR    ] 2023-09-11 17:03:42,000 Could not enable parallelism: mpi4py is not installed\nyt : [INFO     ] 2023-09-11 17:03:42,051 Parameters: current_time              = 3.156010944496386e+16\nyt : [INFO     ] 2023-09-11 17:03:42,052 Parameters: domain_dimensions         = [96 96 96]\nyt : [INFO     ] 2023-09-11 17:03:42,052 Parameters: domain_left_edge          = [-6.171e+22 -6.171e+22 -6.171e+22]\nyt : [INFO     ] 2023-09-11 17:03:42,053 Parameters: domain_right_edge         = [1.234e+23 1.234e+23 1.234e+23]\nyt : [INFO     ] 2023-09-11 17:03:42,053 Parameters: cosmological_simulation   = 0\nyt : [INFO     ] 2023-09-11 17:03:43,794 xlim = -15428387904811624824832.000000 15428387904811624824832.000000\nyt : [INFO     ] 2023-09-11 17:03:43,796 ylim = -15428387904811624824832.000000 15428387904811624824832.000000\nyt : [INFO     ] 2023-09-11 17:03:43,797 zlim = -92554999999999995019264.000000 92554999999999995019264.000000\nyt : [INFO     ] 2023-09-11 17:03:43,799 Making a fixed resolution buffer of (('gas', 'CoolingmR')) 800 by 800\nyt : [INFO     ] 2023-09-11 17:03:59,817 Projection completed\nyt : [INFO     ] 2023-09-11 17:03:59,821 Making a fixed resolution buffer of (CoolingmR) 128 by 128\n\n\n\n\n\nDataset                          Time       Lum Max    Lum average    Lum std dev       \n---------------------------------------------------------------------------------------------------------------------------------------    \n windCRs_hdf5_plt_cnt_0050       1000.080      4.11e+07 mR     8.7e+04 mR     1.89e+06 mR       \n\n\n\nThis script can be extended further to show H-alpha emission across different velocity channels, for instance to see how slow vs fast-moving gas compares in emission. This is left as an exercise for now, but see Ciampa+ 2020 (incl. Bustard) for an example."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "From Galaxy Atmospheres to Saving Earth’s Atmosphere",
    "section": "",
    "text": "LMC Analysis: Part I\n\n\n\n\n\n\n\nPython\n\n\ndata analysis\n\n\n\n\n\n\n\n\n\n\n\nSep 11, 2023\n\n\nChad Bustard\n\n\n\n\n\n\n  \n\n\n\n\nFrom Galaxy Atmospheres to Saving Earth’s Atmosphere\n\n\n\n\n\n\n\nnews\n\n\n\n\n\n\n\n\n\n\n\nSep 8, 2023\n\n\nChad Bustard\n\n\n\n\n\n\nNo matching items"
  }
]