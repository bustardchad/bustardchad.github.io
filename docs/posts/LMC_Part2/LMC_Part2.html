<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-09-12">

<title>Chad Bustard - Data Analysis and Visualization for Astrophysics Research: Part II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Chad Bustard</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Bustard_Resume.pdf" rel="" target=""><i class="bi bi-file-text" role="img">
</i> 
 <span class="menu-text">Resume/CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/bustardchad" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/chad-bustard-phd-20628090/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text">LinkedIn</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://ui.adsabs.harvard.edu/search/fq=%7B!type%3Daqp%20v%3D%24fq_database%7D&amp;fq_database=database%3A%20(astronomy%20OR%20physics)&amp;q=author%3A(%22Bustard%2C%20Chad%22)&amp;sort=citation_count%20desc%2C%20bibcode%20desc&amp;p_=0" rel="" target=""><i class="bi bi-files" role="img">
</i> 
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="mailto:bustardchad@gmail.com" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text">Email</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Data Analysis and Visualization for Astrophysics Research: Part II</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Python</div>
                <div class="quarto-category">data analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 12, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>In this post, we’ll continue to analyze simulations of the Large Magellanic Cloud, but this time, folding in some real observational data obtained by my collaborators Yong Zheng (University of Rochester) and Kirill Tchernyshov (University of Washington). We will plot values of “ram pressure” across the LMC disk and tabulate them at specific points where there are observational sightlines; this part, followed by an analysis of correlations between local ram pressure, star formation rate (shown below), and observed ion abundances forms the basis for a funded Hubble Space Telescope (HST) grant (PI: Yong Zheng, Co-I: Chad Bustard)</p>
<p><img src="RP_vs_SFR.png" class="img-fluid"></p>
<section id="mock-observables-from-models-of-the-large-magellanic-cloud" class="level2">
<h2 class="anchored" data-anchor-id="mock-observables-from-models-of-the-large-magellanic-cloud">Mock Observables from Models of the Large Magellanic Cloud</h2>
<section id="author-chad-bustard" class="level3">
<h3 class="anchored" data-anchor-id="author-chad-bustard">Author: Chad Bustard</h3>
<p>This notebook goes through a few analyses of simulation data, specifically the simulations published in Bustard et al.&nbsp;2020 of ram pressure stripping and supernova-driven outflows from the Large Magellanic Cloud.</p>
<section id="main-publication-httpsui.adsabs.harvard.eduabs2020apj89329babstract" class="level4">
<h4 class="anchored" data-anchor-id="main-publication-httpsui.adsabs.harvard.eduabs2020apj89329babstract">Main publication: https://ui.adsabs.harvard.edu/abs/2020ApJ…893…29B/abstract</h4>
</section>
</section>
</section>
<section id="ram-pressure" class="level2">
<h2 class="anchored" data-anchor-id="ram-pressure">Ram Pressure</h2>
<p>The ram pressure acting on an object moving with velocity <span class="math inline">\(\bf{v_{infall}}\)</span> through a static background gas with density <span class="math inline">\(\rho\)</span> is, in most basic form:</p>
<p>(most basic) <span class="math inline">\(P_{\rm ram} = \rho v_{\rm infall}^{2}\)</span></p>
<p>This pressure counteracts the gravitational “tension” force of the galaxy to strip gas from the galaxy.</p>
<section id="towards-the-local-ram-pressure-in-different-regions-of-the-lmc" class="level3">
<h3 class="anchored" data-anchor-id="towards-the-local-ram-pressure-in-different-regions-of-the-lmc">Towards the <em>local</em> ram pressure in different regions of the LMC</h3>
<p>The above equation would describe the interaction between a galaxy and a headwind <em>if the velocity offset between the galaxy and headwind were constant across the disk</em>; however, to understand how ram pressure affects local star formation rates, local ion abundances, etc. we would like a more <em>local</em> description of ram pressure.</p>
<p>To a first approximation, we can assume the LMC is a rotating disk infalling at an arbitrary inclination. We have to account for the fact that, from the perspective of the LMC, some parts of the disk are rotating <em>into</em> the headwind while others are rotating <em>away</em> from the headwind. Therefore, the velocity vector of interest is really <span class="math inline">\(v_{\rm infall} - v_{\rm rot}\)</span>, where <span class="math inline">\(v_{\rm rot}(x_{\rm LMC}, y_{\rm LMC}) = (v_{\rm rot,x}, v_{\rm rot,y})\)</span> is the rotation vector (in coordinates such that <span class="math inline">\(\hat{z}\)</span> is along the axis of disk rotation, and <span class="math inline">\(v_{\rm infall} = (v_{x}, v_{y}, v_{z})\)</span> is the infall velocity vector of the LMC “as a whole” motivated by observations and more complete simulations of the LMC’s interaction (including it’s complicated gravitational dance with it’s neighboring SMC):</p>
<p>(including rotation) <span class="math inline">\({\bf P}_{\rm ram}(x_{LMC}, y_{LMC}) = \rho \left((v_{x}-v_{rot,x})^{2}\hat{x} + (v_{y}-v_{rot,y})^{2}\hat{y} + v_{z}^{2}\hat{z}\right)\)</span>.</p>
<p>Note that we’ve written the ram pressure as a vector and with dependence on LMC-centered coordinates <span class="math inline">\((x_{LMC}, y_{LMC})\)</span> in the plane perpendicular to the disk axis of rotation. So to know the ram pressure impacting any point <span class="math inline">\((x_{LMC}, y_{LMC})\)</span> across the disk, we need the following ingredients:</p>
<pre><code>1. The density of the Milky Way halo at the current LMC location. 

2. The infall velocity vector -- really, a combination of the LMC's infall velocity and a sense of it's inclination during infall (you can imagine a disk "slicing" through the air vs a disk "pancaking" through the air).

3. The rotation vector</code></pre>
<p>In our paper, we more fully account for how, over the course of its infall, the LMC changes both its distance from the Milky Way (and therefore the increasing halo gas density it interacts with as it gets closer and closer to the Milky Way) and its inclination.</p>
<p>It’s not worth going into all the observational measurements that lead to estimates of the halo gas density, the infall velocity, etc. Just know that <span class="math inline">\(\rho\)</span>, <span class="math inline">\(v_{x}\)</span>, <span class="math inline">\(v_{y}\)</span>, <span class="math inline">\(v_{z}\)</span> are well-motivated but, of course, have some uncertainties.</p>
<p>The rotation velocity can be calculated by assuming hydrostatic balance between the LMC’s centrifugal force and gravitational force…that’s how it is done in the Fortran-based FLASH simulations I created to model the LMC…but in the next cell, we’ll just take the rotation velocity as a function of <span class="math inline">\(r_{LMC}\)</span> from Salem et al.&nbsp;2015.</p>
<p>An additional complexity we can account for is that galaxies are constantly expelling and accreting gas through the <em>disk-halo interface</em>, here the region between the LMC’s disk and its surrounding <em>circumgalactic medium.</em> These gas flows are “very” challenging to model correctly (no model is ever correct, some are just closer to reality), but my own simulations (Bustard et al.&nbsp;2020) are a first-of-their-kind attempt to model the supernova-driven galactic outflows from the LMC, connecting them to the temporally and spatially resolved star formation history that ultimately determines the time and locations of galactic outflow driving. Check out the .F90 file in this directory for the initial condition and boundary condition code (the FLASH code this is built on is proprietary, so that’s all I can post on Github).</p>
<p>Generalizing <span class="math inline">\(v_{\rm rot}\)</span> to <span class="math inline">\(v_{\rm local} = (v_{loc,x},v_{loc,y},v_{loc,z})\)</span>, which includes all velocity information relative to the frame of rest of the LMC, the full ram pressure can be estimated as</p>
<p>(including local gas flows) <span class="math inline">\({\bf P}_{\rm ram}(x_{LMC}, y_{LMC}, z_{LMC}) = \rho \left((v_{x}-v_{loc,x})^{2}\hat{x} + (v_{y}-v_{loc,y})^{2}\hat{y} + (v_{z} - v_{loc,z})^{2}\hat{z}\right)\)</span></p>
<p>Note that, while rotation doesn’t alter ram pressure in the <span class="math inline">\(\hat{z}\)</span> direction, other gas flows surely can and could be included here.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import all the packages we need</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> trident</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> trident <span class="im">import</span> LightRay</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> aplpy</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#import matplotlib as plt</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> yt.units.yt_array <span class="im">import</span> YTQuantity</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> yt <span class="im">import</span> YTArray</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> h5py</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.io <span class="im">import</span> fits</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.table <span class="im">import</span> Table</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy <span class="im">import</span> wcs</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> astropy.wcs <span class="im">import</span> WCS</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install cmasher <span class="co"># a nice repository of colorblind-friendly, aesthetically pleasing colormaps</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cmasher <span class="im">as</span> cmr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: cmasher in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (1.6.3)
Requirement already satisfied: colorspacious&gt;=1.1.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from cmasher) (1.1.2)
Requirement already satisfied: e13tools&gt;=0.9.4 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from cmasher) (0.9.6)
Requirement already satisfied: matplotlib&gt;=2.2.4 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from cmasher) (3.7.2)
Requirement already satisfied: numpy&gt;=1.16.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from cmasher) (1.25.2)
Requirement already satisfied: contourpy&gt;=1.0.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (1.1.0)
Requirement already satisfied: cycler&gt;=0.10 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (4.42.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (1.4.4)
Requirement already satisfied: packaging&gt;=20.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (23.1)
Requirement already satisfied: pillow&gt;=6.2.0 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (10.0.0)
Requirement already satisfied: pyparsing&lt;3.1,&gt;=2.3.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.7 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from matplotlib&gt;=2.2.4-&gt;cmasher) (2.8.2)
Requirement already satisfied: six&gt;=1.5 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=2.2.4-&gt;cmasher) (1.16.0)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the HDF5 file and additional CSV files from Google Drive link</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install <span class="op">--</span>upgrade <span class="op">--</span>no<span class="op">-</span>cache<span class="op">-</span><span class="bu">dir</span> gdown</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gdown</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>gdown.download_folder(<span class="st">"https://drive.google.com/drive/folders/1cctLEApfIzfdfa0RpisgtKnJzfck4uJK"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Requirement already satisfied: gdown in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (4.7.1)
Requirement already satisfied: filelock in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from gdown) (3.12.2)
Requirement already satisfied: requests[socks] in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from gdown) (2.31.0)
Requirement already satisfied: six in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from gdown) (1.16.0)
Requirement already satisfied: tqdm in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from gdown) (4.65.0)
Requirement already satisfied: beautifulsoup4 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from gdown) (4.12.2)
Requirement already satisfied: soupsieve&gt;1.2 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from beautifulsoup4-&gt;gdown) (2.4.1)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from requests[socks]-&gt;gdown) (3.2.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from requests[socks]-&gt;gdown) (3.4)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from requests[socks]-&gt;gdown) (2.0.4)
Requirement already satisfied: certifi&gt;=2017.4.17 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from requests[socks]-&gt;gdown) (2023.7.22)
Requirement already satisfied: PySocks!=1.5.7,&gt;=1.5.6 in /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages (from requests[socks]-&gt;gdown) (1.7.1)
Processing file 1CD7SLWtpcCW6QZiSvv8AS82auvZAdvZt aligned_LMC_SFR_RP_rotation_ChadVersion.csv
Processing file 13-BB9KNw6GKtKcJbURRa37SLuzQHwqIk ullyses_lmc_dr5_chadedits.csv
Processing file 1BCvIdYOA3VZj91Fdh9seOki0ww3Rqiky windCRs_hdf5_plt_cnt_0050
Building directory structure completed</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Retrieving folder list
Retrieving folder list completed
Building directory structure
Downloading...
From: https://drive.google.com/uc?id=1CD7SLWtpcCW6QZiSvv8AS82auvZAdvZt
To: /Users/chadbustard/Desktop/Quarto_Website/myblog/bustardchad.github.io/posts/LMC_Part2/LMC_high_mass/aligned_LMC_SFR_RP_rotation_ChadVersion.csv
  0%|          | 0.00/4.21k [00:00&lt;?, ?B/s]100%|██████████| 4.21k/4.21k [00:00&lt;00:00, 4.19MB/s]
Downloading...
From: https://drive.google.com/uc?id=13-BB9KNw6GKtKcJbURRa37SLuzQHwqIk
To: /Users/chadbustard/Desktop/Quarto_Website/myblog/bustardchad.github.io/posts/LMC_Part2/LMC_high_mass/ullyses_lmc_dr5_chadedits.csv
  0%|          | 0.00/2.09k [00:00&lt;?, ?B/s]100%|██████████| 2.09k/2.09k [00:00&lt;00:00, 6.42MB/s]
Downloading...
From (uriginal): https://drive.google.com/uc?id=1BCvIdYOA3VZj91Fdh9seOki0ww3Rqiky
From (redirected): https://drive.google.com/uc?id=1BCvIdYOA3VZj91Fdh9seOki0ww3Rqiky&amp;confirm=t&amp;uuid=b304b642-ff8e-47d3-8765-05e1b839e731
To: /Users/chadbustard/Desktop/Quarto_Website/myblog/bustardchad.github.io/posts/LMC_Part2/LMC_high_mass/windCRs_hdf5_plt_cnt_0050
  0%|          | 0.00/668M [00:00&lt;?, ?B/s]  0%|          | 2.62M/668M [00:00&lt;00:25, 26.1MB/s]  1%|          | 5.24M/668M [00:00&lt;00:29, 22.6MB/s]  1%|▏         | 8.91M/668M [00:00&lt;00:25, 26.0MB/s]  2%|▏         | 13.6M/668M [00:00&lt;00:19, 33.2MB/s]  3%|▎         | 18.4M/668M [00:00&lt;00:17, 37.4MB/s]  3%|▎         | 23.1M/668M [00:00&lt;00:16, 40.0MB/s]  4%|▍         | 27.8M/668M [00:00&lt;00:15, 41.7MB/s]  5%|▍         | 32.5M/668M [00:00&lt;00:14, 42.9MB/s]  6%|▌         | 37.2M/668M [00:00&lt;00:14, 43.5MB/s]  6%|▋         | 41.9M/668M [00:01&lt;00:14, 43.9MB/s]  7%|▋         | 46.7M/668M [00:01&lt;00:14, 44.4MB/s]  8%|▊         | 51.4M/668M [00:01&lt;00:14, 44.0MB/s]  8%|▊         | 56.1M/668M [00:01&lt;00:14, 42.0MB/s]  9%|▉         | 60.8M/668M [00:01&lt;00:14, 42.6MB/s] 10%|▉         | 66.1M/668M [00:01&lt;00:13, 44.5MB/s] 11%|█         | 71.8M/668M [00:01&lt;00:12, 46.8MB/s] 11%|█▏        | 76.5M/668M [00:01&lt;00:13, 43.0MB/s] 12%|█▏        | 82.3M/668M [00:01&lt;00:12, 45.8MB/s] 13%|█▎        | 87.0M/668M [00:02&lt;00:12, 45.0MB/s] 14%|█▎        | 91.8M/668M [00:02&lt;00:12, 45.0MB/s] 14%|█▍        | 96.5M/668M [00:02&lt;00:13, 43.8MB/s] 15%|█▌        | 101M/668M [00:02&lt;00:13, 41.5MB/s]  16%|█▌        | 106M/668M [00:02&lt;00:13, 42.8MB/s] 17%|█▋        | 111M/668M [00:02&lt;00:13, 42.7MB/s] 17%|█▋        | 116M/668M [00:02&lt;00:12, 44.0MB/s] 18%|█▊        | 121M/668M [00:02&lt;00:12, 44.4MB/s] 19%|█▊        | 125M/668M [00:02&lt;00:12, 44.7MB/s] 19%|█▉        | 130M/668M [00:03&lt;00:12, 44.8MB/s] 20%|██        | 135M/668M [00:03&lt;00:13, 40.5MB/s] 21%|██        | 141M/668M [00:03&lt;00:11, 46.4MB/s] 22%|██▏       | 146M/668M [00:03&lt;00:11, 44.9MB/s] 23%|██▎       | 151M/668M [00:03&lt;00:12, 41.9MB/s] 23%|██▎       | 156M/668M [00:03&lt;00:12, 41.4MB/s] 24%|██▍       | 160M/668M [00:03&lt;00:12, 42.0MB/s] 25%|██▍       | 166M/668M [00:03&lt;00:11, 43.5MB/s] 25%|██▌       | 170M/668M [00:04&lt;00:11, 44.2MB/s] 26%|██▌       | 175M/668M [00:04&lt;00:11, 44.5MB/s] 27%|██▋       | 180M/668M [00:04&lt;00:10, 44.7MB/s] 28%|██▊       | 185M/668M [00:04&lt;00:10, 44.8MB/s] 28%|██▊       | 189M/668M [00:04&lt;00:12, 37.1MB/s] 29%|██▉       | 193M/668M [00:04&lt;00:17, 27.9MB/s] 30%|██▉       | 199M/668M [00:04&lt;00:14, 31.7MB/s] 31%|███       | 204M/668M [00:04&lt;00:12, 36.0MB/s] 31%|███       | 208M/668M [00:05&lt;00:15, 29.3MB/s] 32%|███▏      | 212M/668M [00:05&lt;00:14, 31.4MB/s] 32%|███▏      | 217M/668M [00:05&lt;00:12, 34.8MB/s] 33%|███▎      | 222M/668M [00:05&lt;00:11, 37.4MB/s] 34%|███▍      | 226M/668M [00:05&lt;00:11, 39.5MB/s] 35%|███▍      | 231M/668M [00:05&lt;00:10, 41.3MB/s] 35%|███▌      | 236M/668M [00:05&lt;00:10, 42.3MB/s] 36%|███▌      | 241M/668M [00:05&lt;00:09, 42.9MB/s] 37%|███▋      | 245M/668M [00:06&lt;00:09, 43.6MB/s] 37%|███▋      | 250M/668M [00:06&lt;00:09, 44.3MB/s] 38%|███▊      | 255M/668M [00:06&lt;00:09, 44.7MB/s] 39%|███▉      | 260M/668M [00:06&lt;00:09, 42.8MB/s] 40%|███▉      | 265M/668M [00:06&lt;00:08, 45.7MB/s] 40%|████      | 270M/668M [00:06&lt;00:08, 45.3MB/s] 41%|████      | 275M/668M [00:06&lt;00:08, 44.7MB/s] 42%|████▏     | 279M/668M [00:06&lt;00:09, 40.5MB/s] 43%|████▎     | 284M/668M [00:06&lt;00:09, 41.2MB/s] 43%|████▎     | 289M/668M [00:07&lt;00:09, 42.2MB/s] 44%|████▍     | 294M/668M [00:07&lt;00:08, 42.7MB/s] 45%|████▍     | 298M/668M [00:07&lt;00:08, 43.1MB/s] 45%|████▌     | 303M/668M [00:07&lt;00:08, 43.0MB/s] 46%|████▌     | 308M/668M [00:07&lt;00:08, 43.7MB/s] 47%|████▋     | 312M/668M [00:07&lt;00:08, 44.1MB/s] 47%|████▋     | 317M/668M [00:07&lt;00:07, 44.5MB/s] 48%|████▊     | 322M/668M [00:07&lt;00:07, 44.8MB/s] 49%|████▉     | 327M/668M [00:07&lt;00:07, 45.1MB/s] 50%|████▉     | 331M/668M [00:07&lt;00:07, 45.1MB/s] 50%|█████     | 336M/668M [00:08&lt;00:07, 44.7MB/s] 51%|█████     | 341M/668M [00:08&lt;00:07, 45.4MB/s] 52%|█████▏    | 346M/668M [00:08&lt;00:07, 45.5MB/s] 52%|█████▏    | 350M/668M [00:08&lt;00:06, 45.5MB/s] 53%|█████▎    | 355M/668M [00:08&lt;00:06, 45.4MB/s] 54%|█████▍    | 360M/668M [00:08&lt;00:06, 45.3MB/s] 55%|█████▍    | 364M/668M [00:08&lt;00:06, 43.6MB/s] 55%|█████▌    | 369M/668M [00:08&lt;00:06, 43.6MB/s] 56%|█████▌    | 374M/668M [00:08&lt;00:06, 44.6MB/s] 57%|█████▋    | 379M/668M [00:09&lt;00:06, 44.8MB/s] 57%|█████▋    | 384M/668M [00:09&lt;00:06, 44.8MB/s] 58%|█████▊    | 388M/668M [00:09&lt;00:06, 44.5MB/s] 59%|█████▉    | 393M/668M [00:09&lt;00:06, 44.6MB/s] 60%|█████▉    | 398M/668M [00:09&lt;00:06, 44.5MB/s] 60%|██████    | 403M/668M [00:09&lt;00:05, 45.1MB/s] 61%|██████    | 407M/668M [00:09&lt;00:05, 45.1MB/s] 62%|██████▏   | 412M/668M [00:09&lt;00:05, 45.2MB/s] 62%|██████▏   | 417M/668M [00:09&lt;00:05, 43.7MB/s] 63%|██████▎   | 422M/668M [00:10&lt;00:05, 44.0MB/s] 64%|██████▍   | 426M/668M [00:10&lt;00:06, 34.9MB/s] 64%|██████▍   | 430M/668M [00:10&lt;00:08, 29.7MB/s] 65%|██████▌   | 435M/668M [00:10&lt;00:07, 31.7MB/s] 66%|██████▌   | 439M/668M [00:10&lt;00:06, 35.0MB/s] 66%|██████▋   | 444M/668M [00:10&lt;00:06, 36.3MB/s] 67%|██████▋   | 449M/668M [00:10&lt;00:05, 39.4MB/s] 68%|██████▊   | 454M/668M [00:10&lt;00:05, 40.3MB/s] 69%|██████▊   | 459M/668M [00:11&lt;00:04, 42.6MB/s] 69%|██████▉   | 463M/668M [00:11&lt;00:04, 43.2MB/s] 70%|███████   | 468M/668M [00:11&lt;00:04, 43.8MB/s] 71%|███████   | 473M/668M [00:11&lt;00:04, 44.1MB/s] 71%|███████▏  | 478M/668M [00:11&lt;00:04, 44.6MB/s] 72%|███████▏  | 482M/668M [00:11&lt;00:04, 45.0MB/s] 73%|███████▎  | 487M/668M [00:11&lt;00:04, 44.2MB/s] 74%|███████▎  | 492M/668M [00:11&lt;00:03, 45.4MB/s] 74%|███████▍  | 497M/668M [00:11&lt;00:03, 45.4MB/s] 75%|███████▌  | 502M/668M [00:12&lt;00:03, 45.3MB/s] 76%|███████▌  | 506M/668M [00:12&lt;00:03, 43.3MB/s] 76%|███████▋  | 511M/668M [00:12&lt;00:03, 44.1MB/s] 77%|███████▋  | 516M/668M [00:12&lt;00:03, 44.4MB/s] 78%|███████▊  | 521M/668M [00:12&lt;00:03, 40.7MB/s] 79%|███████▊  | 525M/668M [00:12&lt;00:03, 41.9MB/s] 79%|███████▉  | 530M/668M [00:12&lt;00:03, 42.8MB/s] 80%|████████  | 535M/668M [00:12&lt;00:03, 43.7MB/s] 81%|████████  | 539M/668M [00:12&lt;00:02, 44.2MB/s] 81%|████████▏ | 544M/668M [00:12&lt;00:02, 44.5MB/s] 82%|████████▏ | 549M/668M [00:13&lt;00:02, 44.9MB/s] 83%|████████▎ | 554M/668M [00:13&lt;00:02, 44.9MB/s] 84%|████████▎ | 558M/668M [00:13&lt;00:02, 43.8MB/s] 84%|████████▍ | 563M/668M [00:13&lt;00:02, 44.2MB/s] 85%|████████▍ | 568M/668M [00:13&lt;00:02, 44.5MB/s] 86%|████████▌ | 573M/668M [00:13&lt;00:02, 44.7MB/s] 86%|████████▋ | 577M/668M [00:13&lt;00:02, 44.6MB/s] 87%|████████▋ | 582M/668M [00:13&lt;00:01, 45.0MB/s] 88%|████████▊ | 587M/668M [00:13&lt;00:01, 45.1MB/s] 88%|████████▊ | 591M/668M [00:14&lt;00:01, 43.8MB/s] 89%|████████▉ | 596M/668M [00:14&lt;00:01, 43.8MB/s] 90%|████████▉ | 601M/668M [00:14&lt;00:01, 45.3MB/s] 91%|█████████ | 606M/668M [00:14&lt;00:01, 40.8MB/s] 91%|█████████▏| 611M/668M [00:14&lt;00:01, 42.3MB/s] 92%|█████████▏| 616M/668M [00:14&lt;00:01, 43.2MB/s] 93%|█████████▎| 620M/668M [00:14&lt;00:01, 43.8MB/s] 93%|█████████▎| 625M/668M [00:14&lt;00:01, 42.6MB/s] 94%|█████████▍| 630M/668M [00:14&lt;00:00, 42.8MB/s] 95%|█████████▍| 635M/668M [00:15&lt;00:00, 44.3MB/s] 96%|█████████▌| 640M/668M [00:15&lt;00:00, 44.6MB/s] 96%|█████████▋| 644M/668M [00:15&lt;00:00, 44.9MB/s] 97%|█████████▋| 649M/668M [00:15&lt;00:00, 44.9MB/s] 98%|█████████▊| 654M/668M [00:15&lt;00:00, 40.5MB/s] 98%|█████████▊| 658M/668M [00:15&lt;00:00, 33.6MB/s] 99%|█████████▉| 663M/668M [00:15&lt;00:00, 36.5MB/s]100%|█████████▉| 667M/668M [00:15&lt;00:00, 38.8MB/s]100%|██████████| 668M/668M [00:15&lt;00:00, 41.9MB/s]
Download completed</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>['/Users/chadbustard/Desktop/Quarto_Website/myblog/bustardchad.github.io/posts/LMC_Part2/LMC_high_mass/aligned_LMC_SFR_RP_rotation_ChadVersion.csv',
 '/Users/chadbustard/Desktop/Quarto_Website/myblog/bustardchad.github.io/posts/LMC_Part2/LMC_high_mass/ullyses_lmc_dr5_chadedits.csv',
 '/Users/chadbustard/Desktop/Quarto_Website/myblog/bustardchad.github.io/posts/LMC_Part2/LMC_high_mass/windCRs_hdf5_plt_cnt_0050']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotation velocity from Salem+ 2015</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># In the form I obtained it, the velocity is tabulated as a function of cylindrical radius (zero radius is the center of the LMC)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's use scipy to fit an exponential curve to our data </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> curve_fit</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> func(x,a,b,c):</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">*</span> np.exp(<span class="op">-</span>b <span class="op">*</span> x) <span class="op">+</span> c</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># radius in units of kiloparsecs (kpc)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>r_data <span class="op">=</span> [<span class="fl">0.025</span>,<span class="fl">0.091</span>,<span class="fl">0.223</span>,<span class="fl">0.364</span>,<span class="fl">0.496</span>,<span class="fl">0.709</span>,<span class="fl">0.84</span>,<span class="fl">1.043</span>,<span class="fl">1.316</span>,<span class="fl">1.569</span>,<span class="fl">1.893</span>,<span class="fl">2.227</span>,<span class="fl">2.642</span>,<span class="fl">3.107</span>,<span class="fl">3.573</span>,<span class="fl">4.038</span>,<span class="fl">4.464</span>,<span class="fl">4.879</span>,<span class="fl">5.294</span>,<span class="fl">5.698</span>,<span class="fl">6.144</span>,<span class="fl">6.579</span>,<span class="fl">6.953</span>,<span class="fl">7.308</span>,<span class="fl">7.763</span>,<span class="fl">8.381</span>,<span class="fl">9.008</span>,<span class="fl">9.524</span>, <span class="fl">9.975</span>]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># rotational velocity</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>v_data <span class="op">=</span> [<span class="fl">21.671</span>,<span class="fl">25.196</span>,<span class="fl">30.809</span>,<span class="fl">35.64</span>,<span class="fl">40.47</span>,<span class="fl">45.822</span>,<span class="fl">49.086</span>,<span class="fl">53.264</span>,<span class="fl">58.355</span>,<span class="fl">62.533</span>,<span class="fl">66.449</span>,<span class="fl">69.582</span>,<span class="fl">72.715</span>,<span class="fl">75.718</span>,<span class="fl">77.546</span>,<span class="fl">79.373</span>,<span class="fl">80.287</span>,<span class="fl">81.07</span>,<span class="fl">81.593</span>,<span class="fl">81.984</span>,<span class="fl">82.115</span>,<span class="fl">82.245</span>,<span class="fl">82.245</span>,<span class="fl">81.984</span>,  <span class="fl">82.115</span>,<span class="fl">81.854</span>,<span class="fl">81.723</span>,<span class="fl">81.07</span>,<span class="fl">80.94</span>]</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>r_arr <span class="op">=</span> np.arange(<span class="fl">0.01</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>popt, pcov <span class="op">=</span> curve_fit(func, r_data, v_data)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">#print(popt)</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>plt.plot(r_data,v_data,label<span class="op">=</span><span class="st">"From Salem2015"</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>plt.plot(r_arr, func(r_arr, <span class="op">*</span>popt), <span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'fit: a=</span><span class="sc">%5.3f</span><span class="st">, b=</span><span class="sc">%5.3f</span><span class="st">, c=</span><span class="sc">%5.3f</span><span class="st">'</span> <span class="op">%</span> <span class="bu">tuple</span>(popt))</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"x (kpc)"</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Velocity (km/s)"</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="LMC_Part2_files/figure-html/cell-4-output-1.png" width="585" height="429"></p>
</div>
</div>
<p>This curve with appropriate values for a, b, c fits the data extremely well (that functional form is physically motivated, so I knew it would work well), so let’s take the magnitude of the velocity to be <span class="math inline">\(v(r) = a e^{-br} + c\)</span> from now on and proceed to calculate the ram pressure.</p>
<p>For the remainder of this notebook, we employ the <code>yt</code> package, a visualization and analysis toolkit for astrophysics: https://yt-project.org/. We first create a new function for the “most basic” ram pressure given the “headwind” <span class="math inline">\(v_{\rm infall}\)</span>, and then the next order ram pressure that also takes into account the disk rotation <span class="math inline">\(v_{\rm rot}\)</span> into/away from the headwind.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define new functions for ram pressure</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _ramPres_norot(field, data): <span class="co"># ram pressure #1, NOT including rotation effect or local gas flows</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># density of the Milky Way halo at present-day position of LMC is rho = 1.65e-28 g/cm^3</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># v_infall = (220, 159, 192) km/s</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        val <span class="op">=</span> <span class="fl">1.65e-28</span><span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'g/cm**3'</span>)<span class="op">*</span>((<span class="fl">220.0</span><span class="op">*</span><span class="fl">1e5</span><span class="op">*</span>data[<span class="st">'ones'</span>]<span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'cm/s'</span>))<span class="op">**</span><span class="fl">2.0</span> <span class="op">+</span> (<span class="fl">159.0</span><span class="op">*</span><span class="fl">1e5</span><span class="op">*</span>data[<span class="st">'ones'</span>]<span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'cm/s'</span>))<span class="op">**</span><span class="fl">2.0</span> <span class="op">+</span> (<span class="fl">192.0</span><span class="op">*</span><span class="fl">1e5</span><span class="op">*</span>data[<span class="st">'ones'</span>]<span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'cm/s'</span>))<span class="op">**</span><span class="fl">2.0</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> val</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>yt.add_field((<span class="st">"gas"</span>,<span class="st">"ramPres_norot"</span>), function<span class="op">=</span>_ramPres_norot, sampling_type<span class="op">=</span><span class="st">'local'</span>,units<span class="op">=</span><span class="st">"dyne/cm**2"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _ramPres_rot(field, data): <span class="co"># ram pressure #2, including rotation effect but not local gas flows</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        rad <span class="op">=</span> np.sqrt((data[<span class="st">'x'</span>]<span class="op">**</span><span class="fl">2.0</span> <span class="op">+</span> data[<span class="st">'y'</span>]<span class="op">**</span><span class="fl">2.0</span>)) <span class="co"># radius from center of LMC</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        velrot_y <span class="op">=</span> <span class="fl">1.e5</span><span class="op">*</span>func(rad,<span class="op">*</span>popt)<span class="op">*</span>data[<span class="st">'x'</span>]<span class="op">/</span>rad<span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'cm/s'</span>) <span class="co"># v_y in units of km/s</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        velrot_x <span class="op">=</span> <span class="fl">1.e5</span><span class="op">*</span>func(rad,<span class="op">*</span>popt)<span class="op">*</span>data[<span class="st">'y'</span>]<span class="op">/</span>rad<span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'cm/s'</span>) <span class="co"># v_x</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># density of the Milky Way halo at present-day position of LMC is rho = 1.65e-28 g/cm^3</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># v_infall = (220, 159, 192) km/s</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        val <span class="op">=</span> <span class="fl">1.65e-28</span><span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'g/cm**3'</span>)<span class="op">*</span>((<span class="fl">220.0</span><span class="op">*</span><span class="fl">1e5</span><span class="op">*</span>data[<span class="st">'ones'</span>]<span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'cm/s'</span>) <span class="op">-</span> velrot_x)<span class="op">**</span><span class="fl">2.0</span> <span class="op">+</span> (<span class="fl">159.0</span><span class="op">*</span><span class="fl">1e5</span><span class="op">*</span>data[<span class="st">'ones'</span>]<span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'cm/s'</span>) <span class="op">-</span> velrot_y)<span class="op">**</span><span class="fl">2.0</span> <span class="op">+</span> (<span class="fl">192.0</span><span class="op">*</span><span class="fl">1e5</span><span class="op">*</span>data[<span class="st">'ones'</span>]<span class="op">*</span>YTQuantity(<span class="dv">1</span>,<span class="st">'cm/s'</span>))<span class="op">**</span><span class="fl">2.0</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> val</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>yt.add_field((<span class="st">"gas"</span>,<span class="st">"ramPres_rot"</span>), function<span class="op">=</span>_ramPres_rot, sampling_type<span class="op">=</span><span class="st">'local'</span>,units<span class="op">=</span><span class="st">"dyne/cm**2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load in the dataset and set line of sight vector L</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ds <span class="op">=</span> yt.load(<span class="st">"LMC_high_mass/windCRs_hdf5_plt_cnt_0050"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>dd <span class="op">=</span> ds.all_data()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> [<span class="op">-</span><span class="fl">0.561</span>,<span class="fl">0.099</span>,<span class="fl">0.822</span>] <span class="co"># vector normal to cutting plane</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>north_vector <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>sky_center <span class="op">=</span> [<span class="fl">79.0</span>,<span class="op">-</span><span class="fl">68.68</span>] <span class="co"># in degrees</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>sky_scale <span class="op">=</span> (<span class="fl">4123.71</span>, <span class="st">"arcsec/kpc"</span>) <span class="co"># could also use a YTQuantity</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Restrict our plot to just the galaxy (cells with an ISM tag &gt; 0.6)</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>cut_data <span class="op">=</span> dd.cut_region(<span class="st">'(obj["ism "] &gt; 0.6)'</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Make plots along the line of sight and save as FITS files for future access</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>prj_fits <span class="op">=</span> yt.FITSOffAxisProjection(ds,L,<span class="st">'ramPres_norot'</span>,center <span class="op">=</span> (<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),width<span class="op">=</span>(<span class="dv">20</span>, <span class="st">'kpc'</span>), weight_field<span class="op">=</span><span class="st">"ones"</span>,data_source<span class="op">=</span>cut_data)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>prj_fits.create_sky_wcs(sky_center, sky_scale, ctype<span class="op">=</span>[<span class="st">"RA---TAN"</span>,<span class="st">"DEC--TAN"</span>], replace_old_wcs<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>prj_fits.writeto(<span class="st">"LMC_ram_RP_norotate.fits"</span>, overwrite<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>prj_fits <span class="op">=</span> yt.FITSOffAxisProjection(ds,L,<span class="st">'ramPres_rot'</span>,center <span class="op">=</span> (<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),width<span class="op">=</span>(<span class="dv">20</span>, <span class="st">'kpc'</span>), weight_field<span class="op">=</span><span class="st">"ones"</span>,data_source<span class="op">=</span>cut_data)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>sky_center <span class="op">=</span> [<span class="fl">79.0</span>,<span class="op">-</span><span class="fl">68.68</span>] <span class="co"># in degrees</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>sky_scale <span class="op">=</span> (<span class="fl">4123.71</span>, <span class="st">"arcsec/kpc"</span>) <span class="co"># could also use a YTQuantity</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>prj_fits.create_sky_wcs(sky_center, sky_scale, ctype<span class="op">=</span>[<span class="st">"RA---TAN"</span>,<span class="st">"DEC--TAN"</span>], replace_old_wcs<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>prj_fits.writeto(<span class="st">"LMC_ram_RP_rotate.fits"</span>, overwrite<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>yt : [INFO     ] 2023-09-13 16:07:21,263 Parameters: current_time              = 3.156010944496386e+16
yt : [INFO     ] 2023-09-13 16:07:21,263 Parameters: domain_dimensions         = [96 96 96]
yt : [INFO     ] 2023-09-13 16:07:21,264 Parameters: domain_left_edge          = [-6.171e+22 -6.171e+22 -6.171e+22]
yt : [INFO     ] 2023-09-13 16:07:21,264 Parameters: domain_right_edge         = [1.234e+23 1.234e+23 1.234e+23]
yt : [INFO     ] 2023-09-13 16:07:21,264 Parameters: cosmological_simulation   = 0
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/unyt/array.py:1906: RuntimeWarning: invalid value encountered in divide
  out_arr = func(
yt : [INFO     ] 2023-09-13 16:07:31,100 Making a FITS image of field ramPres_norot
/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/unyt/array.py:1906: RuntimeWarning: invalid value encountered in divide
  out_arr = func(
yt : [INFO     ] 2023-09-13 16:07:46,206 Making a FITS image of field ramPres_rot</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>image_data_norot <span class="op">=</span> fits.getdata(<span class="st">'LMC_ram_RP_norotate.fits'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>image_data_rot <span class="op">=</span> fits.getdata(<span class="st">'LMC_ram_RP_rotate.fits'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"image type: "</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">type</span>(image_data_rot)))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape of image: "</span> <span class="op">+</span><span class="bu">str</span>(image_data_rot.shape))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a quick plotting function we can use again</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_fits(fits_file):</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> aplpy.FITSFigure(fits_file)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    fig.add_grid()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    fig.show_colorscale(cmap<span class="op">=</span><span class="st">"kamae_r"</span>,stretch <span class="op">=</span> <span class="st">'linear'</span>, vmin<span class="op">=</span><span class="fl">1E-13</span>, vmax <span class="op">=</span> <span class="fl">3.5E-13</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    fig.tick_labels.set_xposition(<span class="st">"top"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    fig.ticks.set_xspacing(<span class="fl">8.0</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    fig.ticks.set_yspacing(<span class="fl">8.0</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    fig.add_colorbar()</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.tick_labels.set_xformat('hh:mm')</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    fig.tick_labels.set_xformat(<span class="st">'dd'</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    fig.tick_labels.set_yformat(<span class="st">'dd'</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.set_theme('pretty')</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    fig.colorbar.show(log_format<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    fig.colorbar.set_font(size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#fig.show()</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plot ram pressure with and without rotation</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>plot_fits(<span class="st">"LMC_ram_RP_norotate.fits"</span>)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>plot_fits(<span class="st">"LMC_ram_RP_rotate.fits"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>image type: &lt;class 'numpy.ndarray'&gt;
shape of image: (512, 512)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="LMC_Part2_files/figure-html/cell-7-output-2.png" width="818" height="729"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="LMC_Part2_files/figure-html/cell-7-output-3.png" width="818" height="729"></p>
</div>
</div>
<p>The top panel, not accounting for rotation, obviously shows a constant ram pressure across the whole disk since there is no dependence on position. The bottom panel, however, reflects that the true ram pressure is highest in the lower left corner where the disk is rotating into the headwind. Let’s overlay some observational sightlines and tabulate ram pressure for each sightline.</p>
</section>
</section>
<section id="reading-in-sightlines" class="level2">
<h2 class="anchored" data-anchor-id="reading-in-sightlines">Reading in sightlines</h2>
<p>We read in sightlines from a pre-made CSV file that provides RA, DEC coordinates for each one</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in table of (RA, DEC) values for sightlines through the LMC</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>inputArr <span class="op">=</span> np.genfromtxt(<span class="st">'LMC_high_mass/ullyses_lmc_dr5_chadedits.csv'</span>,delimiter<span class="op">=</span><span class="st">','</span>,invalid_raise<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>ra_data <span class="op">=</span> inputArr[:,<span class="dv">0</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>ra_data <span class="op">=</span> ra_data[<span class="dv">1</span>:<span class="bu">len</span>(ra_data)]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>dec_data <span class="op">=</span> inputArr[:,<span class="dv">1</span>]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>dec_data <span class="op">=</span> dec_data[<span class="dv">1</span>:<span class="bu">len</span>(dec_data)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s take a quick look at the file header for the ram pressure FITS file we created. It shows the “World Coordinate System (WCS)” keywords, including the type of axes we are using (RA–TAN and DEC–TAN) and the number of points along each axis (512 x 512)</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> fits.<span class="bu">open</span>(<span class="st">"LMC_ram_RP_rotate.fits"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> wcs.WCS(f[<span class="dv">0</span>].header)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WCS Keywords

Number of WCS axes: 2
CTYPE : 'RA---TAN'  'DEC--TAN'  
CRVAL : 79.0  -68.68  
CRPIX : 256.5  256.5  
PC1_1 PC1_2  : 1.0  0.0  
PC2_1 PC2_2  : 0.0  1.0  
CDELT : -0.0447451171875  0.0447451171875  
NAXIS : 512  512</code></pre>
</div>
</div>
<p>We’ll make use of Astropy’s built-in transformations to map from world coordinates to pixel coordinates. That way we can figure out where each sightline, given to us in world coordinates, lies on our simulation grid: https://python4astronomers.github.io/astropy/wcs.html</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert from world to pixel coords</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ra_test, dec_test <span class="op">=</span> w.wcs_world2pix(ra_data, dec_data, <span class="dv">1</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make some quick plots </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.plot(ra_data,ra_test)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"RA Inputs"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Pixel Outputs"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.plot(dec_data,dec_test)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"DEC Inputs"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Pixel Outputs"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="LMC_Part2_files/figure-html/cell-10-output-1.png" width="593" height="429"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="LMC_Part2_files/figure-html/cell-10-output-2.png" width="593" height="429"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># access the ram pressure values from ramPres_rot file</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ram_arr <span class="op">=</span> f[<span class="st">"ramPres_rot"</span>].data</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>rp_pixel_coords <span class="op">=</span> []</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(ra_data)):</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    ra, dec <span class="op">=</span> w.wcs_world2pix(ra_data[j], dec_data[j], <span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    ra <span class="op">=</span> <span class="bu">int</span>(ra)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    dec <span class="op">=</span> <span class="bu">int</span>(dec)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    rp_pixel_coords.append(ram_arr[dec,ra])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Open the CSV file using Pandas, call it df</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'LMC_high_mass/ullyses_lmc_dr5_chadedits.csv'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column for RP -- units are dyne/cm^2</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'RP(dyne/cm^2)'</span>] <span class="op">=</span> rp_pixel_coords</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the new dataframe df</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the sightlines in RA, DEC coordinates, with color = ram pressure magnitude    </span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>sc <span class="op">=</span> plt.scatter(ra_data,dec_data, c <span class="op">=</span> rp_pixel_coords,cmap<span class="op">=</span><span class="st">"Greens"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>plt.colorbar(sc)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Ram Pressure (Rotation Included)"</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_xaxis()</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"RA (ICRS)"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"DEC (ICRS)"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Write df (with appended column for RP values) to a new CSV file </span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">'RP_Rotation_dr5_Sept2022.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     RA(deg)  Dec(deg)  Unnamed: 2  RP(dyne/cm^2)
0    71.7686  -67.1148         NaN   1.402618e-13
1    72.5789  -67.6606         NaN   1.505098e-13
2    73.4304  -68.7148         NaN   1.813268e-13
3    73.6329  -67.2568         NaN   1.490383e-13
4    73.7390  -70.0412         NaN   2.281196e-13
..       ...       ...         ...            ...
105  85.7289  -68.9485         NaN   2.372947e-13
106  85.8042  -67.8544         NaN   2.204783e-13
107  86.0963  -67.2414         NaN   2.106828e-13
108  86.4664  -67.2405         NaN   2.117671e-13
109  87.2069  -70.0661         NaN   2.493760e-13

[110 rows x 4 columns]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="LMC_Part2_files/figure-html/cell-12-output-2.png" width="626" height="471"></p>
</div>
</div>
</section>
<section id="quick-analysis-of-ram-pressure-vs-star-formation-rate" class="level1">
<h1>Quick analysis of ram pressure vs star formation rate</h1>
<p>A question of interest: does ram pressure correlate with star formation rate? We hypothesize that higher ram pressure causes more gas compression, leading to gravitational instability and gas collapse, eventually forming stars. With a birds-eye view of star formation in the LMC, combined with ram pressure values taken from these simulations, do we find a correlation?</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>inputArr <span class="op">=</span> np.genfromtxt(<span class="st">'LMC_high_mass/aligned_LMC_SFR_RP_rotation_ChadVersion.csv'</span>,delimiter<span class="op">=</span><span class="st">','</span>, invalid_raise<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>SFR <span class="op">=</span> inputArr[:,<span class="dv">0</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>SFR <span class="op">=</span> SFR[<span class="dv">1</span>:<span class="bu">len</span>(SFR)]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>ra <span class="op">=</span> inputArr[:,<span class="dv">1</span>]</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>ra <span class="op">=</span> ra[<span class="dv">1</span>:<span class="bu">len</span>(ra)]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>dec <span class="op">=</span> inputArr[:,<span class="dv">2</span>]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>dec <span class="op">=</span> dec[<span class="dv">1</span>:<span class="bu">len</span>(dec)]</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>RP <span class="op">=</span> inputArr[:,<span class="dv">3</span>]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>RP <span class="op">=</span> RP[<span class="dv">1</span>:<span class="bu">len</span>(RP)]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>plt.plot(RP, SFR,<span class="st">'bo'</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"RP vs SFR (rotation included)"</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Ram Pressure"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"SFR"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">"SFR_RP_wholeDisk.pdf"</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="LMC_Part2_files/figure-html/cell-13-output-1.png" width="663" height="471"></p>
</div>
</div>
<p>Across <em>all</em> sightlines sampling the entire LMC disk, there’s only a slight correlation. One route towards further insights would be to separate the data into different quadrants depending on LMC position. But the sampling is clearly not spatially uniform…we’re really interested in what the mean star formation rate is in different regions, as well as the variance in those regions. To that end, we can coarse-grain our data and look for correlations.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dec range is -65 to -72</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ra range is 70 to 90</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Testing mask to show only SFRs inside a certain region: "</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> np.where((dec <span class="op">&gt;</span> <span class="op">-</span><span class="dv">70</span>) <span class="op">&amp;</span> (dec <span class="op">&lt;</span> <span class="op">-</span><span class="dv">64</span>) <span class="op">&amp;</span> (ra <span class="op">&lt;</span> <span class="dv">90</span>) <span class="op">&amp;</span> (ra <span class="op">&gt;</span> <span class="dv">80</span>))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(SFR[test])</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Can play around here with different numbers of bins (numbin) and RA, DEC ranges</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>numbin <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>ra_min, ra_max <span class="op">=</span> <span class="dv">70</span>, <span class="dv">90</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>dec_min, dec_max <span class="op">=</span> <span class="op">-</span><span class="dv">72</span>, <span class="op">-</span><span class="dv">65</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>raGrid <span class="op">=</span> np.arange(ra_min,ra_max,((ra_max<span class="op">-</span>ra_min)<span class="op">/</span>numbin))</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>decGrid <span class="op">=</span> np.arange(dec_max,dec_min,((dec_min<span class="op">-</span>dec_max)<span class="op">/</span>numbin))</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># populate new arrays SFR_new and RP_new with average SFR, RP in coarse-grained bins</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Calculate variances and add them to figure also</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>SFR_new <span class="op">=</span> [<span class="dv">0</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(raGrid)<span class="op">*</span><span class="bu">len</span>(decGrid))]</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>RP_new <span class="op">=</span> [<span class="dv">0</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(raGrid)<span class="op">*</span><span class="bu">len</span>(decGrid))]</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(raGrid)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(decGrid)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        counter <span class="op">+=</span><span class="dv">1</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> warnings.catch_warnings():</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>            warnings.simplefilter(<span class="st">"ignore"</span>, category<span class="op">=</span><span class="pp">RuntimeWarning</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>            location <span class="op">=</span> np.where((dec <span class="op">&lt;</span> decGrid[j]) <span class="op">&amp;</span> (dec <span class="op">&gt;</span> decGrid[j<span class="op">+</span><span class="dv">1</span>]) <span class="op">&amp;</span> (ra <span class="op">&lt;</span> raGrid[i<span class="op">+</span><span class="dv">1</span>]) <span class="op">&amp;</span>   (ra <span class="op">&gt;</span> raGrid[i]))</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>            avgSFR <span class="op">=</span> np.mean(<span class="dv">10</span><span class="op">**</span>(SFR[location]))</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>            avgRP <span class="op">=</span> np.mean(RP[location])</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (avgSFR <span class="op">&gt;</span> <span class="dv">0</span>):</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>                SFR_new[counter] <span class="op">=</span> np.log10(avgSFR)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>                RP_new[counter] <span class="op">=</span> np.log10(avgRP)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SFR averages: "</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(SFR_new)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>xnew <span class="op">=</span> raGrid <span class="op">+</span> ((ra_max<span class="op">-</span>ra_min)<span class="op">/</span>numbin)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>ynew <span class="op">=</span> decGrid <span class="op">+</span>((dec_min<span class="op">-</span>dec_max)<span class="op">/</span>numbin)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>x,y <span class="op">=</span> np.meshgrid(xnew, ynew)</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of SFR averages, color is log10(RP)</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>plt.scatter(x,y, c <span class="op">=</span> SFR_new,cmap<span class="op">=</span><span class="st">'Blues_r'</span>,vmin <span class="op">=</span> <span class="op">-</span><span class="fl">8.0</span>, vmax <span class="op">=</span> <span class="op">-</span><span class="dv">6</span>)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>plt.gca().invert_xaxis()</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"RA"</span>)</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"DEC"</span>)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="vs">r"Average SFR"</span>)</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">"AverageSFR_coarseRes.pdf"</span>)</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Testing mask to show only SFRs inside a certain region: 
[-7.71 -7.16 -7.04 -7.04 -7.52 -7.05 -7.05 -7.34 -7.09 -7.47 -7.67 -7.5
 -7.65 -7.65 -7.37 -7.39 -7.28 -7.06 -7.52 -7.64 -7.42 -7.77 -7.36 -7.12
 -7.13 -7.11 -6.82 -7.11 -7.56 -7.16 -7.17 -6.74 -7.37 -6.84 -6.3  -6.68
 -6.26 -7.11 -6.28 -6.08 -6.43 -6.33 -6.01 -6.02 -6.02 -6.15 -6.82 -6.75
 -6.72 -6.93 -6.69 -7.02 -7.41 -7.44 -7.39 -7.64 -7.7 ]
SFR averages: 
[0, -6.804233570533134, -7.453491512184222, -7.718155183284904, -7.6920671165286745, -7.2168688857093, -7.107898374506615, -7.547369968505555, -7.231256155907228, -6.5215524045230815, 0, 0, 0, 0, 0, 0]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="LMC_Part2_files/figure-html/cell-14-output-2.png" width="586" height="449"></p>
</div>
</div>
<p>These figures aren’t too illuminating either, but there is clearly some spatial variation of SFR, on average, that could correlate with ram pressure. However, ram pressure variation <em>overall</em> is quite low – less than a dex – probably reflecting the limitation of our ram pressure calculation so far: we haven’t included any varying contribution from gas flows above and below the disk. Indeed, since the LMC is “pancaking” during infall through the Milky Way halo, the dominant ram pressure component is vertical, and in Bustard et al.&nbsp;2020, we found a clear “shielding” effect where galactic fountains are cut down by a significant headwind on the near side of the LMC disk but can flow almost unimpeded on the far side of the disk.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>